"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1811],{11811:(A,D,r)=>{r.r(D),r.d(D,{TodoComponent:()=>I});var _=r(10467),g=r(81391),t=r(93953),y=r(36815),m=r(52002),E=r(31439),k=r(34635),L=r(62590),T=r(60177),b=r(88834),h=r(18498),f=r(96850),v=r(99213);const C=n=>["/app","todo",n];function P(n,c){1&n&&(t.j41(0,"span",9),t.EFF(1,"Personal"),t.k0s())}function O(n,c){if(1&n&&(t.j41(0,"div",7),t.EFF(1),t.k0s()),2&n){const o=c.$implicit;t.R7$(),t.Lme("",o.data.description," (",o.data.completed,")")}}function M(n,c){if(1&n){const o=t.RV6();t.j41(0,"div",5)(1,"h2",10),t.EFF(2),t.k0s(),t.j41(3,"div",6,0),t.bIt("cdkDropListDropped",function(e){t.eBV(o);const d=t.XpG();return t.Njj(d.drop(e))}),t.Z7z(5,O,2,2,"div",7,t.fX1),t.k0s()()}if(2&n){const o=c.$implicit,i=t.XpG(),e=t.sdS(27);t.R7$(),t.Y8G("routerLink",t.eq3(4,C,o.id)),t.R7$(),t.JRh(o.data.title),t.R7$(),t.Y8G("cdkDropListData",i.todo)("cdkDropListConnectedTo",e),t.R7$(2),t.Dyx(o.todos)}}function R(n,c){if(1&n&&(t.j41(0,"div",7),t.EFF(1),t.k0s()),2&n){const o=c.$implicit;t.R7$(),t.JRh(o)}}function j(n,c){if(1&n&&(t.j41(0,"div",7),t.EFF(1),t.k0s()),2&n){const o=c.$implicit;t.R7$(),t.JRh(o)}}function F(n,c){1&n&&(t.j41(0,"span",9),t.EFF(1,"Business"),t.k0s())}function x(n,c){1&n&&(t.j41(0,"span",9),t.EFF(1,"Groceries"),t.k0s())}let I=(()=>{class n{constructor(){var o=this;this.todo=["Get to work","Pick up groceries","Go home","Fall asleep"],this.done=["Get up","Brush teeth","Take a shower","Check e-mail","Walk dog"],this.layout=(0,t.WQX)(y.Y),this.list=(0,t.vPA)([]),this.todos=(0,t.vPA)([]),this.app=(0,t.WQX)(E.d),this.identity=(0,t.WQX)(k.K),this.route=(0,t.WQX)(h.nX),this.selectedList=(0,t.vPA)(null),this.selectedRecord=(0,t.vPA)(null),this.layout.marginOn(),this.layout.resetActions(),(0,t.QZP)((0,_.A)(function*(){o.app.initialized()&&(yield o.load())}),{allowSignalWrites:!0}),this.route.paramMap.subscribe(i=>{this.layout.marginOff();const e=i.get("id");this.selectedList.set(e&&":id"!=e?i.get("id"):null)}),(0,t.QZP)((0,_.A)(function*(){o.app.initialized()&&o.selectedList()&&(yield o.loadList(o.selectedList()))}),{allowSignalWrites:!0})}loadList(o){var i=this;return(0,_.A)(function*(){i.todos.set([]);const{record:e}=yield i.identity.web5.dwn.records.read({message:{filter:{recordId:o}}});i.selectedRecord.set(e);const{records:d}=yield i.identity.web5.dwn.records.query({message:{filter:{parentId:o}}}),a=yield e.data.json();console.log(a);for(let s of d){const l=yield s.data.json(),p={record:s,data:l,id:s.id};i.todos.update(u=>[...u,p])}})()}getList(o){var i=this;return(0,_.A)(function*(){console.log("GET LIST:",o);const{record:e}=yield i.identity.web5.dwn.records.read({message:{filter:{recordId:o}}}),{records:d}=yield i.identity.web5.dwn.records.query({message:{filter:{parentId:o}}}),s=(yield e.data.json(),[]);for(let l of d){const p=yield l.data.json();s.push({record:l,data:p,id:l.id})}return s})()}load(){var o=this;return(0,_.A)(function*(){const{records:i}=yield o.identity.web5.dwn.records.query({message:{filter:{schema:m.Q.types.list.schema},dateSort:L.U0.CreatedAscending}});console.log("Saved records",i);for(let e of i){const d=yield e.data.json();let a={record:e,data:d,id:e.id};a.todos=yield o.getList(a.id),o.list.update(s=>[...s,a])}})()}newTodo(){var o=this;return(0,_.A)(function*(){const e={completed:!1,description:"description",author:o.identity.did,parentId:o.selectedRecord().id},{record:d}=yield o.identity.web5.dwn.records.create({data:e,message:{protocol:m.Q.protocol,protocolPath:"list/todo",schema:m.Q.types.todo.schema,dataFormat:m.Q.types.todo.dataFormats[0],parentContextId:e.parentId}}),s=yield d.data.json(),l={todoRecord:d,data:s,id:d.id};o.todos.update(u=>[...u,l]);const{status:p}=yield d.send("did:dht:bi3bzoke6rq6fbkojpo5ebtg45eqx1owqrb4esex8t9nz14ugnao");202===p.code?console.log("Sent todo to recipient"):console.log("Unable to send to target did:"+p)})()}newList(){var o=this;return(0,_.A)(function*(){const i="did:dht:bi3bzoke6rq6fbkojpo5ebtg45eqx1owqrb4esex8t9nz14ugnao",e={type:"list",title:"Hello",description:"What to do?",author:o.identity.did,recipient:i},{record:d}=yield o.identity.web5.dwn.records.create({data:e,message:{protocol:m.Q.protocol,protocolPath:"list",schema:m.Q.types.list.schema,dataFormat:m.Q.types.list.dataFormats[0],recipient:i}}),a=yield d.data.json(),s={record:d,data:a,id:d.id};o.list.update(p=>[...p,s]);const{status:l}=yield d.send(i);console.log("Send status:",l)})()}drop(o){o.previousContainer===o.container?(0,g.HD)(o.container.data,o.previousIndex,o.currentIndex):(0,g.eg)(o.previousContainer.data,o.container.data,o.previousIndex,o.currentIndex)}static#t=this.\u0275fac=function(i){return new(i||n)};static#o=this.\u0275cmp=t.VBU({type:n,selectors:[["app-todo"]],standalone:!0,features:[t.aNF],decls:36,vars:5,consts:[["todoList","cdkDropList"],["doneList","cdkDropList"],["mat-tab-label",""],["mat-flat-button","",3,"click"],["mat-flat-button","",3,"click","disabled"],[1,"container"],["cdkDropList","",1,"list",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"list-item"],[1,"container","responsive-grid"],[1,"hide-small"],[1,"clickable",3,"routerLink"]],template:function(i,e){if(1&i){const d=t.RV6();t.j41(0,"mat-tab-group")(1,"mat-tab"),t.DNE(2,P,2,0,"ng-template",2),t.j41(3,"div"),t.nrm(4,"br"),t.j41(5,"button",3),t.bIt("click",function(){return t.eBV(d),t.Njj(e.newList())}),t.EFF(6,"New list"),t.k0s(),t.EFF(7,"\xa0 "),t.j41(8,"button",4),t.bIt("click",function(){return t.eBV(d),t.Njj(e.newTodo())}),t.EFF(9,"New todo"),t.k0s(),t.nrm(10,"br")(11,"br"),t.Z7z(12,M,7,6,"div",5,t.fX1),t.nrm(14,"br")(15,"br"),t.j41(16,"div",5)(17,"h2"),t.EFF(18,"To do"),t.k0s(),t.j41(19,"div",6,0),t.bIt("cdkDropListDropped",function(s){return t.eBV(d),t.Njj(e.drop(s))}),t.Z7z(21,R,2,1,"div",7,t.fX1),t.k0s()(),t.j41(23,"div",5)(24,"h2"),t.EFF(25,"Done"),t.k0s(),t.j41(26,"div",6,1),t.bIt("cdkDropListDropped",function(s){return t.eBV(d),t.Njj(e.drop(s))}),t.Z7z(28,j,2,1,"div",7,t.fX1),t.k0s()()()(),t.j41(30,"mat-tab"),t.DNE(31,F,2,0,"ng-template",2),t.nrm(32,"div",8),t.k0s(),t.j41(33,"mat-tab"),t.DNE(34,x,2,0,"ng-template",2),t.nrm(35,"div",8),t.k0s()()}if(2&i){const d=t.sdS(20),a=t.sdS(27);t.R7$(8),t.Y8G("disabled",!e.selectedList()),t.R7$(4),t.Dyx(e.list()),t.R7$(7),t.Y8G("cdkDropListData",e.todo)("cdkDropListConnectedTo",a),t.R7$(2),t.Dyx(e.todo),t.R7$(5),t.Y8G("cdkDropListData",e.done)("cdkDropListConnectedTo",d),t.R7$(2),t.Dyx(e.done)}},dependencies:[g.T1,g.O7,T.MD,b.Hl,b.$z,h.iI,h.Wk,f.RI,f.ES,f.mq,f.T8,v.m_],styles:[".container[_ngcontent-%COMP%]{width:400px;max-width:100%;margin:0 20px;display:inline-block;vertical-align:top}.list[_ngcontent-%COMP%]{border:solid 1px #ccc;min-height:60px;background:#fff;border-radius:4px;display:block;overflow:hidden}.list-item[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;box-sizing:border-box;cursor:move;background:#fff;color:#000;font-size:14px}.list-item[_ngcontent-%COMP%]:last-child{border:none}.cdk-drag-preview[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .cdk-drag[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .3s cubic-bezier(0,0,.2,1)}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.todo-list[_ngcontent-%COMP%]{margin-bottom:1em;border:1px solid silver;padding:1em;box-sizing:border-box;cursor:pointer}.todo-list[_ngcontent-%COMP%]:hover{border:1px solid gray}"]})}return n})()}}]);