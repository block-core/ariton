"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[92],{10092:(w,p,a)=>{a.r(p),a.d(p,{PasswordResetComponent:()=>M});var l=a(10467),t=a(54438),u=a(88834),o=a(89417),m=a(9183),i=a(53719),c=a(99631),E=a(99213),d=a(25596),P=a(96084),v=a(34635),f=a(30046);function g(e,_){1&e&&(t.j41(0,"h1"),t.EFF(1,"Reset your password"),t.k0s())}function h(e,_){if(1&e&&(t.j41(0,"mat-form-field",4)(1,"mat-label"),t.EFF(2,"Enter your old password"),t.k0s(),t.nrm(3,"input",5),t.k0s(),t.nrm(4,"br")),2&e){const n=t.XpG();t.R7$(3),t.Y8G("formControl",n.passwordInputPrevious)}}function C(e,_){1&e&&t.nrm(0,"mat-spinner",2)}function R(e,_){1&e&&(t.j41(0,"span"),t.EFF(1,"Remove password protection"),t.k0s())}function D(e,_){1&e&&(t.j41(0,"mat-error"),t.EFF(1,"Password is "),t.j41(2,"strong"),t.EFF(3,"invalid"),t.k0s()())}let M=(()=>{class e{constructor(n,r,s){this.appService=n,this.identityService=r,this.router=s,this.passwordInputPrevious=new o.MJ("",o.k0.required),this.reset=(0,t.EWP)(()=>this.appService.agent()?.passwordHash),this.unlocking=(0,t.vPA)(!1),this.invalidPassword=(0,t.vPA)(!1)}ngOnLoad(){return(0,l.A)(function*(){})()}changePassword(n,r){var s=this;return(0,l.A)(function*(){n||(n="insecure-static-phrase"),yield s.identityService.changePassword(n,r),s.appService.agent().password=r,s.appService.agent().passwordHash="",s.appService.saveAgent(s.appService.agent()),console.log("Password changed")})()}onSubmit(){var n=this;return(0,l.A)(function*(){n.unlocking.set(!0);try{let r="";r=n.passwordInputPrevious.value;const s=yield n.appService.crypto.createPassword();yield n.changePassword(r,s)}catch(r){return console.error(r),n.invalidPassword.set(!0),void n.unlocking.set(!1)}n.invalidPassword.set(!1),n.unlocking.set(!1),n.router.navigate(["/introduction"])})()}static{this.\u0275fac=function(r){return new(r||e)(t.rXU(P.d),t.rXU(v.K),t.rXU(f.Ix))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-password-reset"]],standalone:!0,features:[t.aNF],decls:14,vars:5,consts:[[3,"ngSubmit"],["mat-flat-button","","type","submit","color","primary",3,"disabled"],["diameter","20"],["appearance","outlined"],[1,"full-width"],["matInput","","type","password",3,"formControl"]],template:function(r,s){1&r&&(t.DNE(0,g,2,0,"h1"),t.j41(1,"form",0),t.bIt("ngSubmit",function(){return s.onSubmit()}),t.DNE(2,h,5,1),t.j41(3,"button",1),t.DNE(4,C,1,0,"mat-spinner",2)(5,R,2,0,"span"),t.k0s(),t.j41(6,"p"),t.DNE(7,D,4,0,"mat-error"),t.k0s(),t.j41(8,"mat-card",3)(9,"mat-card-content")(10,"strong"),t.EFF(11,"Remove your personal password"),t.k0s(),t.j41(12,"p"),t.EFF(13,"This will enable auto-login on Ariton. You won't need to remember a password."),t.k0s()()()()),2&r&&(t.vxM(s.reset()?0:-1),t.R7$(2),t.vxM(s.reset()?2:-1),t.R7$(),t.Y8G("disabled",!(s.passwordInputPrevious.valid&&!s.unlocking())),t.R7$(),t.vxM(s.unlocking()?4:5),t.R7$(3),t.vxM(s.invalidPassword()?7:-1))},dependencies:[d.Hu,d.RN,d.m2,o.YN,o.qT,o.me,o.BC,o.cb,o.cV,m.D6,m.LG,o.X1,o.l_,i.RG,i.rl,i.nJ,i.TL,c.fS,c.fg,u.Hl,u.$z,E.m_]})}}return e})()}}]);