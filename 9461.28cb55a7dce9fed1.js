"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9461],{39461:(w,f,l)=>{l.r(f),l.d(f,{IssuerComponent:()=>N});var u=l(10467),e=l(54438),c=l(88834),r=l(25596),E=l(99213),y=l(96084),R=l(34635),M=l(76336),m=l(22312),p=l(96850),k=l(36815),D=l(99631),g=l(53719),_=l(89417),T=l(60177),j=l(26703),h=l(5951);function v(o,s){1&o&&(e.j41(0,"mat-icon",18),e.EFF(1,"badge"),e.k0s(),e.EFF(2,"\xa0 Credentials "))}function b(o,s){1&o&&(e.j41(0,"mat-icon",18),e.EFF(1,"verified"),e.k0s(),e.EFF(2,"\xa0 Credential "))}function O(o,s){if(1&o){const t=e.RV6();e.j41(0,"p",13)(1,"strong"),e.EFF(2,"Credential:"),e.k0s(),e.nrm(3,"br"),e.EFF(4),e.j41(5,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.copyValue())}),e.j41(6,"mat-icon"),e.EFF(7,"content_copy"),e.k0s()()()}if(2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.credential," ")}}function P(o,s){1&o&&(e.j41(0,"mat-icon",18),e.EFF(1,"person_search"),e.k0s(),e.EFF(2,"\xa0 Validate"))}function A(o,s){1&o&&(e.j41(0,"mat-icon",20),e.EFF(1,"verified_user"),e.k0s())}function S(o,s){1&o&&(e.j41(0,"mat-icon",20),e.EFF(1,"gpp_bad"),e.k0s())}function B(o,s){1&o&&e.EFF(0," no ")}function U(o,s){1&o&&e.EFF(0," Male ")}function W(o,s){1&o&&e.EFF(0," Female ")}function K(o,s){if(1&o&&(e.j41(0,"h2"),e.EFF(1),e.k0s(),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.DNE(7,U,1,0)(8,W,1,0),e.k0s(),e.j41(9,"p"),e.nrm(10,"img",22),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.JRh(t.lookupCredential.name),e.R7$(2),e.SpI(" ",t.lookupCredential.identifier," "),e.R7$(2),e.SpI(" ",t.lookupCredential.dateOfBirth," "),e.R7$(2),e.vxM("M"==t.lookupCredential.gender?7:8),e.R7$(3),e.Mz_("src","data:image/png;base64,",t.lookupCredential.photo,"",e.B4B)}}function L(o,s){if(1&o&&(e.j41(0,"p")(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e.EFF(4,"Signature Status"),e.k0s()(),e.j41(5,"mat-card-content")(6,"p"),e.DNE(7,A,2,0,"mat-icon",20)(8,S,2,0,"mat-icon",20),e.k0s(),e.j41(9,"p"),e.EFF(10,"The identity with the following DID has "),e.DNE(11,B,1,0),e.EFF(12," valid FreeID:"),e.k0s(),e.j41(13,"p",21),e.EFF(14),e.k0s(),e.DNE(15,K,11,6),e.k0s()()()),2&o){const t=e.XpG();e.R7$(7),e.vxM(t.lookupSigned?7:8),e.R7$(4),e.vxM(t.lookupSigned?-1:11),e.R7$(3),e.SpI(" ",t.did," "),e.R7$(),e.vxM(t.lookupCredential?15:-1)}}let N=(()=>{class o{constructor(){this.vcType="IdentityCredential",this.app=(0,e.WQX)(y.d),this.util=(0,e.WQX)(j.Q),this.identity=(0,e.WQX)(R.K),this.layout=(0,e.WQX)(k.Y),this.loading=!1,this.signed=!1,this.lookupSigned=void 0,this.did="",this.identifier="",this.name="",this.gender="M",this.birthdate="",this.photograph="",this.credential="",this.issueDate="",this.expiryDate="",this.vc=null,this.lookupCredential=null,this.layout.marginOff();const t=new Date;t.setHours(24,59,59,0);const a=new Date(t);a.setFullYear(a.getFullYear()+5),this.issueDate=t.toISOString(),this.expiryDate=a.toISOString(),(0,e.QZP)(()=>{this.app.initialized()&&this.load()})}load(){var t=this;return(0,u.A)(function*(){var{records:a}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:m.eE.format}}});a.length>0&&(t.signed=!0)})()}copyValue(){this.util.copyToClipboard(this.credential)}sign(){var t=this;return(0,u.A)(function*(){t.loading=!0;const a=new Date;a.setFullYear(a.getFullYear()+5),a.setHours(24,0,0,0);const n=yield M.l6.create({type:t.vcType,issuer:t.identity.did,subject:t.did,data:{identifier:t.identifier,name:t.name,dateOfBirth:t.birthdate,gender:t.gender,photo:t.photograph},expirationDate:a.toISOString()}),d=yield t.identity.activeAgent().did.get({didUri:t.identity.did});console.log("DID:",d);const i=yield t.identity.activeAgent().identity.list();console.log("Identitites:",i);const I=yield t.identity.activeAgent().identity.get({didUri:t.identity.did});console.log("this.identity.did:",t.identity.did),console.log("Bearer DID:",I),console.log("Active Agent:",t.identity.activeAgent());const F=yield n.sign({did:I.did});t.credential=F;const{record:C}=yield t.identity.web5.dwn.records.create({data:F,message:{tags:{type:"FreeID"},schema:t.vcType,dataFormat:m.eE.format,published:!0}});console.log("VC RECORD:",C);const{status:H}=yield C.send(t.identity.did);console.log("Record sent:",H,C),t.signed=!0,t.loading=!1})()}lookup(){var t=this;return(0,u.A)(function*(){t.lookupSigned=void 0;const{records:a}=yield t.identity.web5.dwn.records.query({from:t.did,message:{filter:{tags:{type:"FreeID"},schema:t.vcType,dataFormat:m.eE.format}}});if(console.log("VC RECORDS:",a),a.length>0){t.lookupSigned=!0;const n=yield a[0].data.text(),d=M.l6.parseJwt({vcJwt:n});t.vc=d,t.lookupCredential=d.vcDataModel.credentialSubject,console.log("VC:",d)}else t.lookupSigned=!1})()}withdraw(){var t=this;return(0,u.A)(function*(){var{records:a}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:m.eE.format}}});for(const n of a)yield n.delete(),n.send(t.identity.did);t.loading=!1,t.signed=!1})()}static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-issuer"]],standalone:!0,features:[e.aNF],decls:66,vars:12,consts:[["mat-tab-label",""],[1,"padding"],[1,"credential-form"],[1,"did-input"],["matInput","","placeholder","DID",3,"ngModelChange","ngModel"],["matInput","","placeholder","Eg. LFID-07-0001-01",3,"ngModelChange","ngModel"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matInput","","placeholder","Birthdate",3,"ngModelChange","ngModel"],[1,"gender-input",3,"ngModelChange","ngModel"],["value","M"],["value","F"],["matInput","","placeholder","Photograph",3,"ngModelChange","ngModel"],[1,"wrap"],["mat-flat-button","",3,"click","disabled"],["subscriptSizing","dynamic",1,"did-input"],["matInput","","placeholder","DID...",3,"ngModelChange","keydown.enter","ngModel"],["mat-icon-button","",1,"chat-action",3,"click"],[1,"example-tab-icon"],["matTooltip","Copy the credential","mat-icon-button","",1,"copy-button",3,"click"],["inline","true",1,"signature-icon"],[1,"ellipsis"],[3,"src"]],template:function(a,n){1&a&&(e.j41(0,"mat-tab-group")(1,"mat-tab"),e.DNE(2,v,3,0,"ng-template",0),e.j41(3,"div",1)(4,"mat-card")(5,"mat-card-content")(6,"h1"),e.EFF(7,"Choose Credential to issue"),e.k0s(),e.j41(8,"p"),e.EFF(9,"To be done: Add a list of available schemas to choose from."),e.k0s()()()()(),e.j41(10,"mat-tab"),e.DNE(11,b,3,0,"ng-template",0),e.j41(12,"div",1)(13,"mat-card")(14,"mat-card-header")(15,"mat-card-title"),e.EFF(16," Issue Credential "),e.k0s()(),e.j41(17,"mat-card-content",2)(18,"mat-form-field",3)(19,"mat-label"),e.EFF(20,"Decentralized Identifier (DID)"),e.k0s(),e.j41(21,"input",4),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.k0s()(),e.j41(22,"mat-form-field",3)(23,"mat-label"),e.EFF(24,"Identifier (ISSUER-YEAR-IDENTIFIER-SEQUENCE)"),e.k0s(),e.j41(25,"input",5),e.mxI("ngModelChange",function(i){return e.DH7(n.identifier,i)||(n.identifier=i),i}),e.k0s()(),e.j41(26,"mat-form-field",3)(27,"mat-label"),e.EFF(28,"Date of issue"),e.k0s(),e.j41(29,"input",6),e.mxI("ngModelChange",function(i){return e.DH7(n.issueDate,i)||(n.issueDate=i),i}),e.k0s()(),e.j41(30,"mat-form-field",3)(31,"mat-label"),e.EFF(32,"Date of expiry"),e.k0s(),e.j41(33,"input",6),e.mxI("ngModelChange",function(i){return e.DH7(n.expiryDate,i)||(n.expiryDate=i),i}),e.k0s()(),e.j41(34,"mat-form-field",3)(35,"mat-label"),e.EFF(36,"Name"),e.k0s(),e.j41(37,"input",7),e.mxI("ngModelChange",function(i){return e.DH7(n.name,i)||(n.name=i),i}),e.k0s()(),e.j41(38,"mat-form-field",3)(39,"mat-label"),e.EFF(40,"Birthdate"),e.k0s(),e.j41(41,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(n.birthdate,i)||(n.birthdate=i),i}),e.k0s()(),e.j41(42,"mat-radio-group",9),e.mxI("ngModelChange",function(i){return e.DH7(n.gender,i)||(n.gender=i),i}),e.j41(43,"mat-radio-button",10),e.EFF(44,"Male"),e.k0s(),e.j41(45,"mat-radio-button",11),e.EFF(46,"Female"),e.k0s()(),e.j41(47,"mat-form-field",3)(48,"mat-label"),e.EFF(49,"Photograph (Base64)"),e.k0s(),e.j41(50,"input",12),e.mxI("ngModelChange",function(i){return e.DH7(n.photograph,i)||(n.photograph=i),i}),e.k0s()(),e.DNE(51,O,8,1,"p",13),e.k0s(),e.j41(52,"mat-card-actions")(53,"button",14),e.bIt("click",function(){return n.sign()}),e.EFF(54," Sign and Save Credential (Public Accessible) "),e.k0s()()()()(),e.j41(55,"mat-tab"),e.DNE(56,P,3,0,"ng-template",0),e.j41(57,"div",1)(58,"h2"),e.EFF(59,"Check verification status"),e.k0s(),e.j41(60,"mat-form-field",15)(61,"input",16),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.bIt("keydown.enter",function(){return n.lookup()}),e.k0s()(),e.j41(62,"button",17),e.bIt("click",function(){return n.lookup()}),e.j41(63,"mat-icon"),e.EFF(64,"search"),e.k0s()(),e.DNE(65,L,16,4,"p"),e.k0s()()()),2&a&&(e.R7$(21),e.R50("ngModel",n.did),e.R7$(4),e.R50("ngModel",n.identifier),e.R7$(4),e.R50("ngModel",n.issueDate),e.R7$(4),e.R50("ngModel",n.expiryDate),e.R7$(4),e.R50("ngModel",n.name),e.R7$(4),e.R50("ngModel",n.birthdate),e.R7$(),e.R50("ngModel",n.gender),e.R7$(8),e.R50("ngModel",n.photograph),e.R7$(),e.vxM(n.credential?51:-1),e.R7$(2),e.Y8G("disabled",n.loading),e.R7$(8),e.R50("ngModel",n.did),e.R7$(4),e.vxM(void 0!==n.lookupSigned?65:-1))},dependencies:[T.MD,D.fS,D.fg,g.rl,g.nJ,g.RG,_.YN,_.me,_.BC,_.vS,_.X1,r.Hu,r.RN,r.YY,r.m2,r.MM,r.dh,E.m_,E.An,c.Hl,c.$z,c.iY,p.RI,p.ES,p.mq,p.T8,h.Wk,h.VT,h._g],styles:[".did-input[_ngcontent-%COMP%]{width:100%}.signature-icon[_ngcontent-%COMP%]{font-size:4em}.gender-input[_ngcontent-%COMP%]{margin-bottom:1em;display:inline-block}.credential-form[_ngcontent-%COMP%]{padding-top:1em}"]})}}return o})()}}]);