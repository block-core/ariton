"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6489],{58249:(N,D,a)=>{a.d(D,{K:()=>O});var f=a(10467),t=a(54438),k=a(34635),x=a(96084),R=a(69371),g=a(76336),b=a(22312),T=a(21093),j=a(68530);let O=(()=>{class y{constructor(){this.requests=(0,t.vPA)([]),this.friends=(0,t.vPA)([]),this.identity=(0,t.WQX)(k.K),this.connection=(0,t.WQX)(T.K),this.app=(0,t.WQX)(x.d)}createRequest(s){var p=this;return(0,f.A)(function*(){const u=yield g.l6.create({type:"FriendshipCredential",issuer:p.identity.did,subject:s,data:null});console.log("VC:",u);const C=yield p.identity.activeAgent().identity.get({didUri:p.identity.did}),m=yield u.sign({did:C.did});return console.log("VC JWT:",m),{record:(yield p.connection.request(s,{app:"friends",title:"I want to be your friend.",vc:m},T.X.Friend)).record}})()}accept(s){var p=this;return(0,f.A)(function*(){const u=s.data.vc;if(!u)throw new Error("The incoming VC is missing.");if(console.log("signedVcJwt:",u),!u)return;try{yield g.l6.verify({vcJwt:u})}catch(B){return void console.error("Error verifying VC:",B)}const C=g.l6.parseJwt({vcJwt:u}),m=C.issuer;if(C.issuer!=s.record.creator)return void console.error("VC issuer is different than data record author");console.log("Friend request validated");const F=yield g.l6.create({type:b.eE.friendship,issuer:p.identity.did,subject:m,data:{vc:u}});console.log("TWO WAY VC:",F);const r=yield p.identity.activeAgent().identity.get({didUri:p.identity.did}),v=yield F.sign({did:r.did});console.log("TWO WAY VC JWT:",v);const{record:l}=yield p.identity.web5.dwn.records.create({data:v,message:{schema:b.eE.friendship,dataFormat:b.eE.format,published:!1}});console.log("TWO WAY VC RECORD:",l),l.send(p.identity.did);const d={title:s.data.title,vc:v,app:"friends"},E={type:T.X.Credential};console.log("SENDING FRIEND REQUEST TO TARGET:",m);const{status:A,record:I}=yield p.identity.web5.dwn.records.create({data:d,store:!1,message:{tags:E,recipient:m,protocol:j.Q.protocol,protocolPath:"request",schema:j.Q.types.request.schema,dataFormat:j.Q.types.request.dataFormats[0]}});console.log("Request create status:",A);const{status:G}=yield I.send(m);return console.log("SENT TO TARGET!!!",G),p.app.openSnackBar(202!==G.code?`Friend request failed.Code: ${G.code}, Details: ${G.detail}.`:"Friend request accepted"),{record:I,data:d,id:I.id}})()}reject(s){var p=this;return(0,f.A)(function*(){console.log("Rejecting request:",s);const u=s.record.recipient==p.identity.did?s.record.creator:s.record.recipient;console.log("Target DID:",u),console.log("this.identity.did:",p.identity.did),console.log("entry.record.recipient:",s.record.recipient),console.log("entry.record.author:",s.record.author),console.log("entry.record.creator:",s.record.creator);const{status:C}=yield s.record.delete(),{status:m}=yield s.record.send(u);console.log("Delete status:",C),console.log("deleteSendStatus:",m),p.requests.update(F=>F.filter(r=>r!==s))})()}processFriends(){var s=this;return(0,f.A)(function*(){var{records:p}=yield s.identity.web5.dwn.records.query({message:{filter:{protocol:b.iU.uri,schema:R.Q.types.credential.schema,dataFormat:R.Q.types.credential.dataFormats[0]}}});console.log("VC Records:",p);for(const u of p){console.log("Record:",u);const C=yield u.data.json();console.log("JSON:",C);try{yield g.l6.verify({vcJwt:C.vc})}catch(v){console.error("Error verifying VC:",v),console.log("THIS REQUEST SHOULD BE DELETED FROM DWN",u.id)}const m=g.l6.parseJwt({vcJwt:C.vc});console.log("PARSED INVCOMING VC:",m),console.log("vc.issuer === this.identity.did:",m.issuer===s.identity.did);const{record:F}=yield s.identity.web5.dwn.records.create({data:C.vc,message:{schema:b.eE.friendship,dataFormat:b.eE.format,published:!1}});console.log("TWO WAY VC RECORD:",F);const{status:r}=yield F.send(s.identity.did);console.log("Record sent:",r,F),yield u?.delete()}})()}loadFriends(){var s=this;return(0,f.A)(function*(){var{records:p}=yield s.identity.web5.dwn.records.query({message:{filter:{schema:b.eE.friendship,dataFormat:b.eE.format}}});if(console.log("Friend VCs:"),console.log(p),s.friends.set([]),p)for(const m of p){let F=yield m.data.text(),r=g.l6.parseJwt({vcJwt:F}),v=r.issuer;r.issuer==s.identity.did&&(v=g.l6.parseJwt({vcJwt:r.vcDataModel.credentialSubject.vc}).issuer);let l={record:m,data:{did:v}};s.friends.update(d=>[...d,l]),console.log("All friends:",s.friends())}})()}static{this.\u0275fac=function(p){return new(p||y)}}static{this.\u0275prov=t.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}}return y})()},96489:(N,D,a)=>{a.r(D),a.d(D,{ProfileComponent:()=>vt});var f=a(10467),t=a(54438),k=a(88834),x=a(71997),R=a(99213),g=a(59115),b=a(30046),T=a(5794),j=a(96850),O=a(34635),y=a(78013),M=a(75351),s=a(51889),p=a(96084),u=a(60177),C=a(9183),m=a(29508),F=a(36815),r=a(58249),v=a(21093),l=a(25596),d=a(89417),E=a(99631),A=a(14823),I=a(53719);let G=(()=>{class e{constructor(o,n){this.dialogRef=o,this.data=n,this.fb=(0,t.WQX)(d.ok),this.form=this.fb.group({body:[null,d.k0.required]})}ngAfterViewInit(){}onColorChange(o){var n=this;return(0,f.A)(function*(){n.data.background=o.target.value})()}static{this.\u0275fac=function(n){return new(n||e)(t.rXU(M.CP),t.rXU(M.Vh))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-post-dialog"]],standalone:!0,features:[t.aNF],decls:11,vars:3,consts:[["body",""],["appearance","outline",1,"full-width"],["maxlength","12000","rows","6","matInput","","placeholder","Post",3,"ngModelChange","ngModel"],["align","end"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","type","submit","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(n,i){if(1&n){const _=t.RV6();t.j41(0,"mat-dialog-content")(1,"mat-form-field",1)(2,"textarea",2,0),t.mxI("ngModelChange",function(h){return t.eBV(_),t.DH7(i.data.body,h)||(i.data.body=h),t.Njj(h)}),t.k0s(),t.j41(4,"mat-hint",3),t.EFF(5),t.k0s()()(),t.j41(6,"mat-dialog-actions",3)(7,"button",4),t.EFF(8,"Cancel"),t.k0s(),t.j41(9,"button",5),t.EFF(10,"Post"),t.k0s()()}if(2&n){const _=t.sdS(3);t.R7$(2),t.R50("ngModel",i.data.body),t.R7$(3),t.SpI("",_.value.length," / 12000"),t.R7$(4),t.Y8G("mat-dialog-close",!0)}},dependencies:[u.MD,A.uc,g.Cn,R.m_,k.Hl,k.$z,E.fS,E.fg,I.rl,I.MV,M.hM,M.tx,M.E7,M.Yi,d.YN,d.me,d.BC,d.tU,d.vS],styles:["form[_ngcontent-%COMP%]{display:inline}"]})}}return e})();var B=a(60385),W=a(98703),V=a(77494),U=a(345);const $=e=>["/app","chat",e],L=()=>["edit"],S=(e,c)=>["/profile",e,"posts",c];function Q(e,c){if(1&e&&(t.nrm(0,"img",4),t.nI1(1,"safeResourceUrl")),2&e){const o=t.XpG(2);t.Y8G("src",t.bMT(1,1,o.data().avatar),t.B4B)}}function Y(e,c){1&e&&t.nrm(0,"img",5)}function K(e,c){if(1&e&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.SpI("(",o.data().profile.title,")")}}function J(e,c){if(1&e){const o=t.RV6();t.j41(0,"button",22),t.bIt("click",function(){t.eBV(o);const i=t.XpG(3);return t.Njj(i.addFriend(i.data().did))}),t.j41(1,"mat-icon"),t.EFF(2,"person_add"),t.k0s()()}}function w(e,c){if(1&e&&(t.j41(0,"button",21)(1,"mat-icon"),t.EFF(2,"chat_bubble"),t.k0s()()),2&e){const o=t.XpG(3);t.Y8G("routerLink",t.eq3(1,$,o.data().did))}}function H(e,c){if(1&e&&t.DNE(0,J,3,0,"button",20)(1,w,3,3,"button",21),2&e){const o=t.XpG(2);t.vxM(o.data().friend?1:0)}}function z(e,c){if(1&e){const o=t.RV6();t.j41(0,"button",25),t.bIt("click",function(){t.eBV(o);const i=t.XpG(3);return t.Njj(i.addFriend(i.data().did))}),t.j41(1,"mat-icon"),t.EFF(2,"person_add"),t.k0s(),t.EFF(3," Add friend "),t.k0s()}}function Z(e,c){if(1&e&&(t.j41(0,"button",24)(1,"mat-icon"),t.EFF(2,"chat_bubble"),t.k0s(),t.EFF(3," Message "),t.k0s()),2&e){const o=t.XpG(3);t.Y8G("routerLink",t.eq3(1,$,o.data().did))}}function q(e,c){if(1&e&&t.DNE(0,z,4,0,"button",23)(1,Z,4,3,"button",24),2&e){const o=t.XpG(2);t.vxM(o.data().friend?1:0)}}function tt(e,c){if(1&e){const o=t.RV6();t.j41(0,"button",11),t.bIt("click",function(){t.eBV(o);const i=t.XpG(3);return t.Njj(i.addFriend(i.data().did))}),t.j41(1,"mat-icon"),t.EFF(2,"person_add"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Add Friend"),t.k0s()()}}function ot(e,c){if(1&e&&(t.j41(0,"button",27)(1,"mat-icon"),t.EFF(2,"chat_bubble"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Message"),t.k0s()()),2&e){const o=t.XpG(3);t.Y8G("routerLink",t.eq3(1,$,o.data().did))}}function et(e,c){if(1&e&&(t.DNE(0,tt,5,0,"button",26)(1,ot,5,3,"button",27),t.nrm(2,"mat-divider")),2&e){const o=t.XpG(2);t.vxM(o.data().friend?1:0)}}function nt(e,c){1&e&&(t.j41(0,"button",27)(1,"mat-icon"),t.EFF(2,"edit"),t.k0s(),t.j41(3,"span"),t.EFF(4,"Edit Profile"),t.k0s()(),t.nrm(5,"mat-divider")),2&e&&t.Y8G("routerLink",t.lJ4(1,L))}function it(e,c){if(1&e){const o=t.RV6();t.nrm(0,"mat-divider"),t.j41(1,"button",11),t.bIt("click",function(){t.eBV(o);const i=t.XpG(2);return t.Njj(i.block(i.data().did))}),t.j41(2,"mat-icon"),t.EFF(3,"block"),t.k0s(),t.j41(4,"span"),t.EFF(5,"Block"),t.k0s()()}}function at(e,c){1&e&&(t.j41(0,"mat-icon",28),t.EFF(1,"notes"),t.k0s(),t.j41(2,"span",29),t.EFF(3,"Posts"),t.k0s())}function rt(e,c){if(1&e){const o=t.RV6();t.j41(0,"mat-card",14)(1,"mat-card-content")(2,"button",30),t.bIt("click",function(){t.eBV(o);const i=t.XpG(2);return t.Njj(i.newPost())}),t.j41(3,"mat-icon"),t.EFF(4,"chat"),t.k0s(),t.EFF(5," Post "),t.k0s(),t.j41(6,"button",31)(7,"mat-icon"),t.EFF(8,"photo_library"),t.k0s(),t.EFF(9," Media "),t.k0s(),t.j41(10,"button",31)(11,"mat-icon"),t.EFF(12,"attach_file"),t.k0s(),t.EFF(13," File "),t.k0s()()()}2&e&&(t.R7$(6),t.Y8G("disabled",!0),t.R7$(4),t.Y8G("disabled",!0))}function st(e,c){if(1&e){const o=t.RV6();t.j41(0,"mat-card",16)(1,"mat-card-header")(2,"div",32),t.nrm(3,"app-profile-header",33),t.j41(4,"button",34)(5,"mat-icon"),t.EFF(6,"more_vert"),t.k0s()(),t.j41(7,"mat-menu",null,1)(9,"button",11),t.bIt("click",function(){const i=t.eBV(o).$implicit,_=t.XpG(2);return t.Njj(_.editPost(i))}),t.j41(10,"mat-icon"),t.EFF(11,"edit"),t.k0s(),t.j41(12,"span"),t.EFF(13,"Edit post"),t.k0s()(),t.j41(14,"button",27)(15,"mat-icon"),t.EFF(16,"note"),t.k0s(),t.j41(17,"span"),t.EFF(18,"View post"),t.k0s()(),t.j41(19,"button",11),t.bIt("click",function(){const i=t.eBV(o).$implicit,_=t.XpG(2);return t.Njj(_.copyUrl(i))}),t.j41(20,"mat-icon"),t.EFF(21,"content_copy"),t.k0s(),t.j41(22,"span"),t.EFF(23,"Copy URL"),t.k0s()(),t.nrm(24,"mat-divider"),t.j41(25,"button",11),t.bIt("click",function(){const i=t.eBV(o).$implicit,_=t.XpG(2);return t.Njj(_.deletePost(i))}),t.j41(26,"mat-icon"),t.EFF(27,"delete"),t.k0s(),t.j41(28,"span"),t.EFF(29,"Delete post"),t.k0s()()()()(),t.j41(30,"mat-card-content")(31,"div",35)(32,"a",36),t.EFF(33),t.nI1(34,"ago"),t.k0s()(),t.j41(35,"div",37),t.EFF(36),t.k0s()()()}if(2&e){const o=c.$implicit,n=t.sdS(8);t.R7$(3),t.Y8G("did",o.record.creator),t.R7$(),t.Y8G("matMenuTriggerFor",n),t.R7$(10),t.Y8G("routerLink",t.l_i(8,S,o.record.creator,o.record.id)),t.R7$(18),t.Y8G("routerLink",t.l_i(11,S,o.record.creator,o.record.id)),t.R7$(),t.JRh(t.bMT(34,6,o.record.dateCreated)),t.R7$(3),t.JRh(o.data.body)}}function lt(e,c){1&e&&(t.j41(0,"mat-icon",28),t.EFF(1,"badge"),t.k0s(),t.j41(2,"span",29),t.EFF(3,"About"),t.k0s())}function dt(e,c){if(1&e&&(t.j41(0,"mat-icon"),t.EFF(1,"event"),t.k0s(),t.j41(2,"span"),t.EFF(3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(3),t.JRh(o.data().profile.birthDate)}}function ct(e,c){if(1&e&&(t.j41(0,"mat-icon"),t.EFF(1,"place"),t.k0s(),t.j41(2,"span"),t.EFF(3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(3),t.JRh(o.data().profile.location)}}function pt(e,c){if(1&e&&(t.j41(0,"mat-icon"),t.EFF(1,"event"),t.k0s(),t.j41(2,"span"),t.EFF(3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(3),t.JRh(o.data().profile.status)}}function _t(e,c){if(1&e&&(t.j41(0,"mat-icon"),t.EFF(1,"link"),t.k0s(),t.EFF(2,"\xa0"),t.j41(3,"a",38),t.EFF(4),t.k0s(),t.EFF(5,"\xa0 ")),2&e){const o=c.$implicit;t.R7$(3),t.Y8G("href",o,t.B4B),t.R7$(),t.JRh(o)}}function mt(e,c){if(1&e&&t.Z7z(0,_t,6,2,null,null,t.fX1),2&e){const o=t.XpG(2);t.Dyx(o.data().profile.links)}}function ut(e,c){if(1&e&&(t.j41(0,"div",19),t.EFF(1),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.SpI(" ",o.data().profile.bio," ")}}function ft(e,c){1&e&&(t.j41(0,"mat-icon",28),t.EFF(1,"diversity_2"),t.k0s(),t.j41(2,"span",29),t.EFF(3,"Communities"),t.k0s())}function ht(e,c){1&e&&(t.j41(0,"mat-icon",28),t.EFF(1,"folder_shared"),t.k0s(),t.j41(2,"span",29),t.EFF(3,"Data"),t.k0s())}function Ct(e,c){if(1&e){const o=t.RV6();t.j41(0,"div",3),t.DNE(1,Q,2,3,"img",4)(2,Y,1,0,"img",5),t.j41(3,"div",6)(4,"h1"),t.EFF(5),t.DNE(6,K,2,1,"span")(7,H,2,1)(8,q,2,1),t.j41(9,"button",7)(10,"mat-icon"),t.EFF(11,"more_vert"),t.k0s()()(),t.j41(12,"span",8)(13,"button",9),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.showQR(i.data().did))}),t.j41(14,"mat-icon"),t.EFF(15,"qr_code"),t.k0s()(),t.EFF(16),t.k0s()(),t.nrm(17,"div",10),t.j41(18,"mat-menu",null,0),t.DNE(20,et,3,1,"mat-divider")(21,nt,6,2),t.j41(22,"button",11),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.showQR(i.data().did))}),t.j41(23,"mat-icon"),t.EFF(24,"qr_code"),t.k0s(),t.j41(25,"span"),t.EFF(26,"Show QR"),t.k0s()(),t.j41(27,"button",11),t.bIt("click",function(){t.eBV(o);const i=t.XpG();return t.Njj(i.shareProfile(i.data()))}),t.j41(28,"mat-icon"),t.EFF(29,"send"),t.k0s(),t.j41(30,"span"),t.EFF(31,"Share Profile"),t.k0s()(),t.DNE(32,it,6,0),t.k0s()(),t.j41(33,"div",12)(34,"mat-tab-group")(35,"mat-tab"),t.DNE(36,at,4,0,"ng-template",13)(37,rt,14,2,"mat-card",14),t.j41(38,"div",15),t.Z7z(39,st,37,14,"mat-card",16,t.fX1),t.k0s()(),t.j41(41,"mat-tab"),t.DNE(42,lt,4,0,"ng-template",13),t.j41(43,"div",17)(44,"div",18),t.DNE(45,dt,4,1)(46,ct,4,1)(47,pt,4,1)(48,mt,2,0),t.k0s(),t.DNE(49,ut,2,1,"div",19),t.k0s()(),t.j41(50,"mat-tab"),t.DNE(51,ft,4,0,"ng-template",13),t.EFF(52," Not implemented yet. "),t.k0s(),t.j41(53,"mat-tab"),t.DNE(54,ht,4,0,"ng-template",13),t.EFF(55," Not implemented yet. "),t.k0s()()()}if(2&e){const o=t.sdS(19),n=t.XpG();t.R7$(),t.vxM(n.data().avatar?1:2),t.R7$(4),t.SpI(" ",n.data().profile.name," "),t.R7$(),t.vxM(n.data().profile.title?6:-1),t.R7$(),t.vxM(n.layout.tiny()?7:8),t.R7$(2),t.Y8G("matMenuTriggerFor",o),t.R7$(7),t.SpI("",n.data().did," "),t.R7$(4),t.vxM(n.data().did!==n.identity.did?20:-1),t.R7$(),t.vxM(n.data().did===n.identity.did?21:-1),t.R7$(11),t.vxM(n.identity.did!==n.data().did?32:-1),t.R7$(5),t.vxM(n.data().did==n.identity.did?37:-1),t.R7$(2),t.Dyx(n.posts()),t.R7$(6),t.vxM(n.data().profile.birthDate?45:-1),t.R7$(),t.vxM(n.data().profile.location?46:-1),t.R7$(),t.vxM(n.data().profile.status?47:-1),t.R7$(),t.vxM(n.data().profile.links&&n.data().profile.links.length>0?48:-1),t.R7$(),t.vxM(n.data().profile.bio?49:-1)}}function gt(e,c){1&e&&(t.j41(0,"div",2),t.nrm(1,"mat-spinner"),t.k0s())}let vt=(()=>{class e{ngOnDestroy(){URL.revokeObjectURL(this.avatarSrc)}constructor(o,n){var i=this;this.sanitizer=o,this.route=n,this.posts=(0,t.vPA)([]),this.profileService=(0,t.WQX)(T.p),this.identity=(0,t.WQX)(O.K),this.connection=(0,t.WQX)(v.K),this.app=(0,t.WQX)(p.d),this.layout=(0,t.WQX)(F.Y),this.friend=(0,t.WQX)(r.K),this.dialog=(0,t.WQX)(M.bZ),this.data=(0,t.vPA)(void 0),this.avatarSrc=null,this.layout.marginOff(),(0,t.QZP)((0,f.A)(function*(){i.app.initialized()&&i.route.paramMap.subscribe(function(){var _=(0,f.A)(function*(P){const h=P.get("id");h&&"undefined"!==h&&(i.did=h,console.log("USER ID SET!!",h),yield i.loadUserProfile(h),yield i.loadPosts(h))});return function(P){return _.apply(this,arguments)}}())}))}loadPosts(o){var n=this;return(0,f.A)(function*(){const i={from:o,message:{filter:{author:o,protocol:m.Q.protocol,protocolPath:"post",schema:m.Q.types.post.schema,dataFormat:m.Q.types.post.dataFormats[0]},dateSort:V.U0.CreatedDescending}};console.log("QUERY: ",i);var{records:_}=yield n.identity.web5.dwn.records.query(i);if(n.posts.set([]),_)for(const h of _){let X=yield h.data.json(),Ft={record:h,data:X};n.posts.update(Et=>[...Et,Ft])}console.log("All posts:",n.posts())})()}newPost(){this.editPost({data:{title:"",body:"",background:"",collaborators:[],labels:[]}})}editPost(o){var n=this;let i={title:o.data.title,body:o.data.body,background:o.data.background,collaborators:[],labels:[""]};const _=JSON.parse(JSON.stringify(i)),P=this.dialog.open(G,{maxWidth:"80vw",maxHeight:"80vh",data:i});return P.afterClosed().subscribe(function(){var h=(0,f.A)(function*(X){X?(console.log("data result for saving:",i),o.data=i,yield n.savePost(o,i)):i=_});return function(X){return h.apply(this,arguments)}}()),P.afterClosed()}deletePost(o){var n=this;return(0,f.A)(function*(){const{status:i}=yield o.record.delete();i&&n.posts.update(_=>_.filter(P=>P.record!=o.record))})()}savePost(o,n){var i=this;return(0,f.A)(function*(){let _;if(n.labels&&n.labels.length>0&&(_={labels:n.labels}),o.record)yield o.record.update({tags:_,data:n,published:!0});else{const{record:P}=yield i.identity.web5.dwn.records.create({data:n,message:{published:!0,tags:_,protocol:m.Q.protocol,protocolPath:"post",schema:m.Q.types.post.schema,dataFormat:m.Q.types.post.dataFormats[0]}});P&&(o.record=P,i.posts.update(X=>[o,...X]),yield o.record.send(i.identity.did))}})()}ngOnInit(){return(0,f.A)(function*(){})()}loadData(){return(0,f.A)(function*(){})()}addFriend(o){var n=this;return(0,f.A)(function*(){yield n.friend.createRequest(o),n.app.openSnackBar("Friend request sent")})()}block(o){var n=this;return(0,f.A)(function*(){yield n.connection.block(o)})()}loadUserProfile(o){var n=this;return(0,f.A)(function*(){try{const i=yield n.profileService.loadProfile(o);n.data.set(i)}catch(i){console.error(i)}})()}copyUrl(o){var n=this;return(0,f.A)(function*(){const i=`${document.location.origin}/profile/${o.record.creator}/posts/${o.record.id}`;try{yield navigator.clipboard.writeText(i),n.app.openSnackBar("Url copied to clipboard")}catch(_){console.error("Failed to copy: ",_)}})()}showQR(o){this.dialog.open(s.k,{data:{did:o}})}shareProfile(o){var n=this;return(0,f.A)(function*(){const i=o.profile.name,_=document.location.href;try{yield navigator.share({title:i,url:_,text:"Check out this profile on Ariton"}),n.app.openSnackBar("Thanks for sharing!")}catch(h){n.app.openSnackBar(`Couldn't share ${h}`)}})()}static{this.\u0275fac=function(n){return new(n||e)(t.rXU(U.up),t.rXU(b.nX))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-profile"]],standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[["menuProfile","matMenu"],["menuActions","matMenu"],[1,"loading-indicator"],[1,"profile-header"],["onerror","this.src='/avatar-placeholder.png';this.onerror='';",1,"profile-header-icon",3,"src"],["src","/avatar-placeholder.png",1,"profile-header-icon"],[1,"profile-header-text"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"ellipsis"],["matTooltip","Show QR code","mat-icon-button","",1,"copy-button",3,"click"],[1,"spacer"],["mat-menu-item","",3,"click"],[1,"profile-content"],["mat-tab-label",""],[1,"toolbar-actions","margin"],[1,"posts-items","margin"],[1,"margin-bottom"],[1,"about-tab-container"],[1,"profile-items"],[1,"profile-bio"],["mat-icon-button","",1,"icon-button"],["mat-icon-button","",1,"icon-button",3,"routerLink"],["mat-icon-button","",1,"icon-button",3,"click"],["mat-button",""],["mat-button","",3,"routerLink"],["mat-button","",3,"click"],["mat-menu-item",""],["mat-menu-item","",3,"routerLink"],[1,"example-tab-icon"],[1,"hide-small"],["type","button","mat-button","",3,"click"],["type","button","mat-button","",3,"disabled"],[1,"posts-header"],[3,"did"],["mat-icon-button","","matTooltip","Options",3,"matMenuTriggerFor"],[1,"post-info"],[1,"link",3,"routerLink"],[1,"post-body"],["target","_blank",3,"href"]],template:function(n,i){1&n&&t.DNE(0,Ct,56,15)(1,gt,2,0,"div",2),2&n&&t.vxM(i.data()?0:1)},dependencies:[M.hM,y.d,j.RI,j.ES,j.mq,j.T8,R.m_,R.An,k.Hl,k.$z,k.iY,g.Cn,g.kk,g.fb,g.Cp,b.Wk,x.w,x.q,u.MD,C.D6,C.LG,l.Hu,l.RN,l.m2,l.MM,B.w,W.g],styles:[".profile-header[_ngcontent-%COMP%]{display:flex;gap:1em;align-items:center}.profile-header-icon[_ngcontent-%COMP%]{border-radius:50%;width:128px;margin:1em}.profile-header-menu[_ngcontent-%COMP%]{padding-right:1em}h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:300}h1[_ngcontent-%COMP%]{margin:0;padding:0}.example-tab-icon[_ngcontent-%COMP%]{margin-right:8px}.profile-content[_ngcontent-%COMP%]{margin-top:.4em}.about-tab-container[_ngcontent-%COMP%]{padding:1em}.profile-items[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:.2em;margin-right:1em}.profile-bio[_ngcontent-%COMP%]{margin-top:1em}.profile-header-text[_ngcontent-%COMP%]{width:100%}.post-body[_ngcontent-%COMP%]{white-space:pre-wrap}.post-info[_ngcontent-%COMP%]{margin-bottom:8px;font-size:.9em}.posts-header[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.posts-header[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{flex-grow:1}.posts-header[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{flex-shrink:0}@media (max-width: 1024px){.profile-header[_ngcontent-%COMP%]{gap:10;flex-direction:column;margin-left:.4em;margin-right:.4em}.profile-header-menu[_ngcontent-%COMP%]{padding-right:.4em}}"]})}}return e})()},60385:(N,D,a)=>{a.d(D,{w:()=>F});var f=a(10467),t=a(54438),k=a(34635),x=a(25596),R=a(5794),g=a(345),b=a(78013),T=a(33347),j=a(14823),O=a(30046);const y=r=>["/profile",r];function M(r,v){if(1&r&&(t.nrm(0,"img",0),t.nI1(1,"safeResourceUrl")),2&r){const l=t.XpG();t.Y8G("routerLink",t.eq3(4,y,l.did()))("src",t.bMT(1,2,l.data().avatar),t.B4B)}}function s(r,v){if(1&r&&t.nrm(0,"img",1),2&r){const l=t.XpG();t.Y8G("routerLink",t.eq3(2,y,l.did()))("src","/avatar-placeholder.png",t.B4B)}}function p(r,v){if(1&r&&t.EFF(0),2&r){let l;const d=t.XpG(2);t.SpI(" (",null==(l=d.data().profile)?null:l.title,") ")}}function u(r,v){if(1&r&&(t.j41(0,"a",3),t.EFF(1),t.DNE(2,p,1,1),t.k0s()),2&r){let l,d;const E=t.XpG();t.Y8G("routerLink",t.eq3(3,y,E.did())),t.R7$(),t.SpI("",null==(l=E.data().profile)?null:l.name," "),t.R7$(),t.vxM(null!=(d=E.data().profile)&&d.title?2:-1)}}function C(r,v){if(1&r&&t.EFF(0),2&r){let l;const d=t.XpG(2);t.SpI(" (",null==(l=d.data().profile)?null:l.title,") ")}}function m(r,v){if(1&r&&(t.j41(0,"em")(1,"a",3),t.EFF(2,"No name set "),t.DNE(3,C,1,1),t.k0s()()),2&r){let l;const d=t.XpG();t.R7$(),t.Y8G("routerLink",t.eq3(2,y,d.did())),t.R7$(2),t.vxM(null!=(l=d.data().profile)&&l.title?3:-1)}}let F=(()=>{class r{constructor(){this.identity=(0,t.WQX)(k.K),this.profile=(0,t.WQX)(R.p),this.sanitizer=(0,t.WQX)(g.up),this.did=t.hFB.required(),this.data=(0,t.vPA)({})}ngAfterViewInit(){var l=this;return(0,f.A)(function*(){if(l.did()){let d=yield l.profile.loadProfile(l.did());l.data.set(d)}})()}static{this.\u0275fac=function(d){return new(d||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-profile-header"]],inputs:{did:[1,"did"]},standalone:!0,features:[t.aNF],decls:10,vars:9,consts:[["mat-card-avatar","","onerror","this.src='/avatar-placeholder.png';this.onerror='';",1,"profile-thumbnail",3,"routerLink","src"],["mat-card-avatar","",1,"profile-thumbnail",3,"routerLink","src"],[1,"profile-header-title"],[3,"routerLink"],[1,"profile-header-subtitle"],[3,"routerLink","matTooltip"]],template:function(d,E){if(1&d&&(t.DNE(0,M,2,6,"img",0)(1,s,1,4,"img",1),t.j41(2,"div")(3,"div",2),t.DNE(4,u,3,5,"a",3)(5,m,4,4,"em"),t.k0s(),t.j41(6,"div",4)(7,"a",5),t.EFF(8),t.nI1(9,"did"),t.k0s()()()),2&d){let A;t.vxM(E.data().avatar?0:1),t.R7$(4),t.vxM(null!=(A=E.data().profile)&&A.name?4:5),t.R7$(3),t.Y8G("routerLink",t.eq3(7,y,E.did()))("matTooltip",E.did()),t.R7$(),t.JRh(t.bMT(9,5,E.did()))}},dependencies:[O.iI,O.Wk,j.uc,j.oV,x.Hu,x.QG,b.d,T.k],styles:[".profile-thumbnail[_ngcontent-%COMP%]{cursor:pointer;border-radius:50%;margin-right:1em}a[_ngcontent-%COMP%]{text-decoration:none}a[_ngcontent-%COMP%]:hover{text-decoration:underline}[_nghost-%COMP%]{display:flex}.profile-header-title[_ngcontent-%COMP%]{font-size:1.4em}.profile-header-subtitle[_ngcontent-%COMP%]{font-size:1em}"]})}}return r})()}}]);