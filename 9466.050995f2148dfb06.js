"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9466],{69466:(J,h,i)=>{i.r(h),i.d(h,{RegistriesComponent:()=>X});var m=i(10467),t=i(54438),f=i(9159),v=i(96695),y=i(2042),P=i(45024),A=i(96354),M=i(57786),S=i(7673);const j=[{id:1,name:"Hydrogen"},{id:2,name:"Helium"},{id:3,name:"Lithium"},{id:4,name:"Beryllium"},{id:5,name:"Boron"},{id:6,name:"Carbon"},{id:7,name:"Nitrogen"},{id:8,name:"Oxygen"},{id:9,name:"Fluorine"},{id:10,name:"Neon"},{id:11,name:"Sodium"},{id:12,name:"Magnesium"},{id:13,name:"Aluminum"},{id:14,name:"Silicon"},{id:15,name:"Phosphorus"},{id:16,name:"Sulfur"},{id:17,name:"Chlorine"},{id:18,name:"Argon"},{id:19,name:"Potassium"},{id:20,name:"Calcium"}];class D extends P.qS{constructor(){super(),this.data=j}connect(){if(this.paginator&&this.sort)return(0,M.h)((0,S.of)(this.data),this.paginator.page,this.sort.sortChange).pipe((0,A.T)(()=>this.getPagedData(this.getSortedData([...this.data]))));throw Error("Please set the paginator and sort on the data source before connecting.")}disconnect(){}getPagedData(s){return this.paginator?s.splice(this.paginator.pageIndex*this.paginator.pageSize,this.paginator.pageSize):s}getSortedData(s){return this.sort&&this.sort.active&&""!==this.sort.direction?s.sort((e,a)=>{const n="asc"===this.sort?.direction;switch(this.sort?.active){case"name":return R(e.name,a.name,n);case"id":return R(+e.id,+a.id,n);default:return 0}}):s}}function R(o,s,e){return(o<s?-1:1)*(e?1:-1)}var l=i(25596),F=i(88834),u=i(30046),$=i(34635),C=i(22312),x=i(60177),B=i(33347),I=i(36815),O=i(96084),T=i(9183),G=i(14823);const E=o=>["/registry",o];function Y(o,s){1&o&&(t.j41(0,"div",0),t.nrm(1,"mat-spinner"),t.k0s())}function Q(o,s){if(1&o&&(t.EFF(0," Website: "),t.j41(1,"a",6),t.EFF(2),t.k0s(),t.nrm(3,"br")),2&o){const e=t.XpG().$implicit;t.R7$(),t.Y8G("href",e.data.url,t.B4B),t.R7$(),t.JRh(e.data.url)}}function L(o,s){if(1&o&&(t.j41(0,"mat-card",1)(1,"mat-card-header"),t.nrm(2,"img",2),t.j41(3,"mat-card-title")(4,"a",3),t.EFF(5),t.k0s()(),t.j41(6,"mat-card-subtitle"),t.EFF(7),t.k0s()(),t.j41(8,"mat-card-content"),t.DNE(9,Q,4,2),t.EFF(10," Owner: "),t.j41(11,"span",4),t.EFF(12),t.nI1(13,"did"),t.k0s(),t.nrm(14,"br")(15,"br"),t.EFF(16),t.k0s(),t.j41(17,"mat-card-actions")(18,"button",5),t.EFF(19,"Open"),t.k0s()()()),2&o){const e=s.$implicit;t.R7$(2),t.Y8G("src",e.data.icon,t.B4B),t.R7$(2),t.Y8G("routerLink",t.eq3(11,E,e.data.registry)),t.R7$(),t.JRh(e.data.name),t.R7$(2),t.JRh(e.data.title),t.R7$(2),t.vxM(e.data.url?9:-1),t.R7$(2),t.Y8G("matTooltip",e.data.owner),t.R7$(),t.JRh(t.bMT(13,9,e.data.owner)),t.R7$(4),t.SpI(" ",e.data.description," "),t.R7$(2),t.Y8G("routerLink",t.eq3(13,E,e.data.registry))}}function N(o,s){if(1&o&&t.Z7z(0,L,20,15,"mat-card",1,t.fX1),2&o){const e=t.XpG();t.Dyx(e.records())}}let X=(()=>{class o{constructor(e){var a=this;this.router=e,this.dataSource=new D,this.identity=(0,t.WQX)($.K),this.app=(0,t.WQX)(O.d),this.records=(0,t.vPA)([]),this.layout=(0,t.WQX)(I.Y),this.loading=(0,t.vPA)(!0),this.layout.marginOn(),this.layout.resetActions(),(0,t.QZP)((0,m.A)(function*(){a.identity.initialized()&&(yield a.load())}))}loadRemote(){var e=this;return(0,m.A)(function*(){const a={from:e.app.aritonDid,message:{filter:{protocol:C.u5.uri,protocolPath:"profile",dataFormat:"application/json"}}};console.log("QUERY:",a);const{records:n}=yield e.identity.web5.dwn.records.query(a);if(console.log("FOUND REGISTRY RECORDS:",n),n){const d=n.map(r=>r.id),c=e.records().map(r=>r.record.id),g=c.filter(r=>!d.includes(r)),z=d.filter(r=>!c.includes(r));e.records.update(r=>[...r.filter(p=>!g.includes(p.record.id))]);for(let r of n)if(z.includes(r.id)){let p=yield r.data.json(),U={record:r,data:p};e.records.update(H=>[...H,U]);const{status:W}=yield r.import();console.log("IMPORT STATUS:",W)}}e.loading.set(!1)})()}load(){var e=this;return(0,m.A)(function*(){const{records:a}=yield e.identity.web5.dwn.records.query({message:{filter:{protocol:C.u5.uri,protocolPath:"profile",dataFormat:"application/json"}}});if(e.records.set([]),a&&a.length>0){for(let n of a){let d=yield n.data.json(),c={record:n,data:d,id:n.id};e.records.update(g=>[...g,c])}e.loading.set(!1),e.loadRemote()}else console.log("There are no records... load remotely"),yield e.loadRemote(),e.loading.set(!1)})()}ngAfterViewInit(){}openRegistry(e){this.router.navigate(["registry",e])}static{this.\u0275fac=function(a){return new(a||o)(t.rXU(u.Ix))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-registries"]],viewQuery:function(a,n){if(1&a&&(t.GBs(v.iy,5),t.GBs(y.B4,5),t.GBs(f.Zl,5)),2&a){let d;t.mGM(d=t.lsd())&&(n.paginator=d.first),t.mGM(d=t.lsd())&&(n.sort=d.first),t.mGM(d=t.lsd())&&(n.table=d.first)}},standalone:!0,features:[t.aNF],decls:2,vars:1,consts:[[1,"loading-indicator"],["appearance","outlined",1,"registry-card"],["mat-card-avatar","",1,"example-header-image",3,"src"],[1,"link",3,"routerLink"],[3,"matTooltip"],["mat-button","",3,"routerLink"],["target","_blank",3,"href"]],template:function(a,n){1&a&&t.DNE(0,Y,2,0,"div",0)(1,N,2,0),2&a&&t.vxM(n.loading()?0:1)},dependencies:[B.k,T.D6,T.LG,x.MD,F.Hl,F.$z,l.Hu,l.RN,l.YY,l.QG,l.m2,l.MM,l.Lc,l.dh,f.tP,v.Ou,y.NQ,G.uc,G.oV,u.iI,u.Wk],styles:[".full-width-table[_ngcontent-%COMP%]{width:100%}.registry-card[_ngcontent-%COMP%]{margin-bottom:1em}.sample-button[_ngcontent-%COMP%]{margin-right:1em;margin-bottom:1em}"]})}}return o})()}}]);