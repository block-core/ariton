"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3672],{23672:(I,f,e)=>{e.r(f),e.d(f,{CreateComponent:()=>A});var c=e(10467),t=e(93953),g=e(83475),p=e(99631),d=e(88834),E=e(82798),C=e(99213),v=e(5951),s=e(25596),o=e(89417),O=e(34635),h=e(39434),P=e(18498),M=e(55619),y=e(22312),m=e(53719),D=e(86600);function b(a,u){if(1&a&&(t.j41(0,"mat-option",8),t.EFF(1),t.k0s()),2&a){const n=u.$implicit;t.Y8G("value",n.type),t.R7$(),t.JRh(n.name)}}function T(a,u){1&a&&(t.j41(0,"mat-error"),t.EFF(1,"About is "),t.j41(2,"strong"),t.EFF(3,"required"),t.k0s()())}function F(a,u){if(1&a){const n=t.RV6();t.j41(0,"div",12)(1,"mat-form-field",5),t.nrm(2,"input",16),t.k0s(),t.j41(3,"button",17),t.bIt("click",function(){const r=t.eBV(n).$index,i=t.XpG();return t.Njj(i.removeOwner(r))}),t.j41(4,"mat-icon"),t.EFF(5,"clear"),t.k0s()()()}if(2&a){const n=u.$index;t.R7$(2),t.Y8G("formControlName",n)}}let A=(()=>{class a{get owners(){return this.form.get("owners")}back(){this.navigation.back()}updateForm(n){console.log("Patching form with:",n),this.form.patchValue({name:n.name,title:n.title,bio:n.bio,status:n.status,location:n.location})}addOwner(){this.owners.push(this.fb.control(""))}removeOwner(n){this.owners.removeAt(n)}constructor(){var n=this;this.fb=(0,t.WQX)(o.ok),this.identity=(0,t.WQX)(O.K),this.profileService=(0,t.WQX)(h.p),this.navigation=(0,t.WQX)(M.o),this.router=(0,t.WQX)(P.Ix),this.data=(0,t.vPA)({}),this.form=this.fb.group({name:[null,o.k0.required],type:[null,o.k0.required],title:[null],status:[null],bio:[null],location:[null],avatar:[""],owners:this.fb.array([this.fb.control("")])}),this.communityTypes=[{type:"general",name:"General"},{type:"power",name:"Power Structure"},{type:"company",name:"Company Structure"}],(0,t.QZP)((0,c.A)(function*(){n.identity.initialized()&&(console.log(n.owners),n.owners.setValue([n.identity.did]))}))}ngOnInit(){}onSubmit(){var n=this;return(0,c.A)(function*(){n.router.navigate(["/community",n.identity.did])})()}upload(n,l){var r=this;return(0,c.A)(function*(){if(n){if(console.log(l),l){console.log("UPDATING IMAGE!!!!");const{status:i,updatedRecord:_}=yield l.update({published:!0,data:n});return console.log("Update profile status:",i,_),_}{const{record:i}=yield r.identity.web5.dwn.records.create({data:n,message:{protocol:y.ME.uri,protocolPath:"avatar",dataFormat:"image/png",tags:{module:"community"}}});return i}}console.log("No image to upload.")})()}static#t=this.\u0275fac=function(l){return new(l||a)};static#n=this.\u0275cmp=t.VBU({type:a,selectors:[["app-create"]],standalone:!0,features:[t.aNF],decls:35,vars:4,consts:[["name",""],["bio",""],["novalidate","",3,"ngSubmit","formGroup"],["formControlName","avatar"],[1,"form-card"],[1,"full-width"],["matInput","","placeholder","Community name","maxlength","200","formControlName","name"],["formControlName","type"],[3,"value"],["maxlength","300","matInput","","placeholder","About","formControlName","bio"],["align","end"],["formArrayName","owners"],[1,"link-input"],["mat-stroked-button","","type","button",3,"click"],["mat-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],["matInput","","type","text","placeholder","Owner (DID)",3,"formControlName"],["mat-icon-button","","type","button",3,"click"]],template:function(l,r){if(1&l){const i=t.RV6();t.j41(0,"form",2),t.bIt("ngSubmit",function(){return t.eBV(i),t.Njj(r.onSubmit())}),t.nrm(1,"app-avatar",3),t.j41(2,"mat-card",4)(3,"mat-card-content")(4,"mat-form-field",5)(5,"mat-label"),t.EFF(6,"Community name"),t.k0s(),t.nrm(7,"input",6,0),t.k0s(),t.j41(9,"mat-form-field",5)(10,"mat-label"),t.EFF(11,"Community type"),t.k0s(),t.j41(12,"mat-select",7),t.Z7z(13,b,2,2,"mat-option",8,t.fX1),t.k0s()(),t.j41(15,"mat-form-field",5)(16,"mat-label"),t.EFF(17,"About"),t.k0s(),t.nrm(18,"textarea",9,1),t.DNE(20,T,4,0,"mat-error"),t.j41(21,"mat-hint",10),t.EFF(22),t.k0s()(),t.j41(23,"div",11),t.Z7z(24,F,6,1,"div",12,t.fX1),t.k0s(),t.j41(26,"button",13),t.bIt("click",function(){return t.eBV(i),t.Njj(r.addOwner())}),t.j41(27,"mat-icon"),t.EFF(28,"add_link"),t.k0s(),t.EFF(29," Add Owner"),t.k0s()(),t.j41(30,"mat-card-actions",10)(31,"button",14),t.bIt("click",function(){return t.eBV(i),t.Njj(r.back())}),t.EFF(32,"Cancel"),t.k0s(),t.j41(33,"button",15),t.EFF(34,"Save"),t.k0s()()()()}if(2&l){const i=t.sdS(19);t.Y8G("formGroup",r.form),t.R7$(13),t.Dyx(r.communityTypes),t.R7$(7),t.vxM(r.form.controls.bio.hasError("required")?20:-1),t.R7$(2),t.SpI("",i.value.length," / 300"),t.R7$(2),t.Dyx(r.owners.controls),t.R7$(9),t.Y8G("disabled",r.form.invalid)}},dependencies:[E.Ve,m.rl,m.nJ,m.MV,m.TL,E.VO,D.wT,g.f,p.fS,p.fg,d.Hl,d.$z,d.iY,C.m_,C.An,v.Wk,s.Hu,s.RN,s.YY,s.m2,o.X1,o.qT,o.me,o.BC,o.cb,o.tU,o.j4,o.JD,o.v8,m.RG,o.YN],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.form-card[_ngcontent-%COMP%]{margin-top:1em}.link-input[_ngcontent-%COMP%]{display:flex;align-items:baseline}.link-input[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:.4em}mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1em}form[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column}"]})}return a})()}}]);