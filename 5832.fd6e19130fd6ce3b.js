"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5832],{55832:(H,M,i)=>{i.r(M),i.d(M,{NotesComponent:()=>z});var d=i(10467),t=i(93953),r=i(89417),u=i(88834),T=i(65571),h=i(53719),_=i(99213),F=i(99631),O=i(36815),S=i(3902),C=i(60177),f=i(59115),N=i(36471),b=i(25596),k=i(14823),m=i(75351);const R=l=>({backgroundColor:l});let V=(()=>{class l{constructor(e,n){this.dialogRef=e,this.data=n,this.fb=(0,t.WQX)(r.ok),this.form=this.fb.group({title:[null],body:[null,r.k0.required],collaborators:["did:dht:6sf3y5rj4f8sq8rctpkp6w3npotmqrypnsdkc74j1n7uiu1raaco"],background:[null]})}ngAfterViewInit(){}onColorChange(e){var n=this;return(0,d.A)(function*(){n.data.background=e.target.value})()}static#t=this.\u0275fac=function(n){return new(n||l)(t.rXU(m.CP),t.rXU(m.Vh))};static#e=this.\u0275cmp=t.VBU({type:l,selectors:[["app-note-dialog"]],standalone:!0,features:[t.aNF],decls:21,vars:11,consts:[["body",""],["fileColor",""],[1,"mat-typography",3,"ngStyle"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Title","maxlength","200",3,"ngModelChange","ngModel"],["maxlength","300","rows","6","matInput","","placeholder","Note",3,"ngModelChange","ngModel"],["align","end"],["align","end",3,"ngStyle"],["mat-icon-button","","matTooltip","Collaborator",3,"disabled"],["mat-icon-button","","matTooltip","Background",3,"click"],["type","color",1,"color-picker",3,"change"],["mat-button","","mat-dialog-close",""],["mat-flat-button","","type","submit","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(n,o){if(1&n){const a=t.RV6();t.j41(0,"mat-dialog-content",2)(1,"mat-form-field",3)(2,"input",4),t.mxI("ngModelChange",function(c){return t.eBV(a),t.DH7(o.data.title,c)||(o.data.title=c),t.Njj(c)}),t.k0s()(),t.j41(3,"mat-form-field",3)(4,"textarea",5,0),t.mxI("ngModelChange",function(c){return t.eBV(a),t.DH7(o.data.body,c)||(o.data.body=c),t.Njj(c)}),t.k0s(),t.j41(6,"mat-hint",6),t.EFF(7),t.k0s()()(),t.j41(8,"mat-dialog-actions",7)(9,"button",8)(10,"mat-icon"),t.EFF(11,"person_add_alt"),t.k0s()(),t.j41(12,"button",9),t.bIt("click",function(){t.eBV(a);const c=t.sdS(16);return t.Njj(c.click())}),t.j41(13,"mat-icon"),t.EFF(14,"palette"),t.k0s()(),t.j41(15,"input",10,1),t.bIt("change",function(c){return t.eBV(a),t.Njj(o.onColorChange(c))}),t.k0s(),t.j41(17,"button",11),t.EFF(18,"Cancel"),t.k0s(),t.j41(19,"button",12),t.EFF(20,"Save"),t.k0s()()}if(2&n){const a=t.sdS(5);t.Y8G("ngStyle",t.eq3(7,R,o.data.background)),t.R7$(2),t.R50("ngModel",o.data.title),t.R7$(2),t.R50("ngModel",o.data.body),t.R7$(3),t.SpI("",a.value.length," / 300"),t.R7$(),t.Y8G("ngStyle",t.eq3(9,R,o.data.background)),t.R7$(),t.Y8G("disabled",!0),t.R7$(10),t.Y8G("mat-dialog-close",!0)}},dependencies:[C.MD,C.B3,k.uc,k.oV,f.Cn,_.m_,_.An,u.Hl,u.$z,u.iY,F.fS,F.fg,h.rl,h.MV,m.hM,m.tx,m.E7,m.Yi,r.YN,r.me,r.BC,r.tU,r.vS],styles:["form[_ngcontent-%COMP%]{display:inline}"]})}return l})();var g=i(69314),$=i(34635),E=i(31439),v=i(82798),j=i(66969),B=i(48067),G=i(86600),I=i(71997);const X=l=>({backgroundColor:l});function x(l,p){if(1&l){const e=t.RV6();t.j41(0,"mat-chip-option",11),t.bIt("click",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.onSelectionChange(o))}),t.EFF(1),t.k0s()}if(2&l){const e=p.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function D(l,p){if(1&l){const e=t.RV6();t.j41(0,"mat-card-title",20),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,a=t.XpG();return t.Njj(a.editNote(o))}),t.EFF(1),t.k0s()}if(2&l){const e=t.XpG().$implicit;t.R7$(),t.JRh(e.data.title)}}function A(l,p){if(1&l&&(t.j41(0,"span",23),t.EFF(1),t.k0s()),2&l){const e=t.XpG(2).$implicit;t.R7$(),t.Lme(" (+",((null==e.data.labels?null:e.data.labels.length)||0)-1," ",2===(null==e.data.labels?null:e.data.labels.length)?"other":"others",") ")}}function P(l,p){if(1&l&&(t.j41(0,"mat-option",8),t.EFF(1),t.k0s()),2&l){const e=p.$implicit;t.Y8G("value",e),t.R7$(),t.JRh(e)}}function Y(l,p){if(1&l){const e=t.RV6();t.j41(0,"mat-card")(1,"mat-form-field",21)(2,"mat-label"),t.EFF(3,"Labels"),t.k0s(),t.j41(4,"mat-select",22),t.mxI("ngModelChange",function(o){t.eBV(e);const a=t.XpG().$implicit;return t.DH7(a.data.labels,o)||(a.data.labels=o),t.Njj(o)}),t.j41(5,"mat-select-trigger"),t.EFF(6),t.DNE(7,A,2,2,"span",23),t.k0s(),t.Z7z(8,P,2,2,"mat-option",8,t.fX1),t.k0s()()()}if(2&l){const e=t.XpG().$implicit,n=t.XpG();t.R7$(4),t.R50("ngModel",e.data.labels),t.R7$(2),t.SpI(" ",(null==e.data.labels?null:e.data.labels[0])||""," "),t.R7$(),t.vxM(((null==e.data.labels?null:e.data.labels.length)||0)>1?7:-1),t.R7$(),t.Dyx(n.labels())}}function Q(l,p){if(1&l){const e=t.RV6();t.j41(0,"mat-card",10),t.DNE(1,D,2,1,"mat-card-title"),t.j41(2,"mat-card-content",12),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.editNote(o))}),t.EFF(3),t.k0s(),t.j41(4,"mat-card-footer")(5,"button",13)(6,"mat-icon"),t.EFF(7,"person_add_alt"),t.k0s()(),t.j41(8,"button",14),t.bIt("click",function(){t.eBV(e);const o=t.sdS(12);return t.Njj(o.click())}),t.j41(9,"mat-icon"),t.EFF(10,"palette"),t.k0s()(),t.j41(11,"input",15,0),t.bIt("change",function(o){const a=t.eBV(e).$implicit,s=t.XpG();return t.Njj(s.onColorChange(o,a))}),t.k0s(),t.j41(13,"button",16,1),t.bIt("click",function(){const o=t.eBV(e).$implicit;return t.Njj(o.open=!o.open)}),t.j41(15,"mat-icon"),t.EFF(16,"new_label"),t.k0s()(),t.DNE(17,Y,10,3,"ng-template",17),t.bIt("backdropClick",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.closeLabelsMenu(o))}),t.j41(18,"button",18)(19,"mat-icon"),t.EFF(20,"more_vert"),t.k0s()(),t.j41(21,"mat-menu",null,2)(23,"button",19),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.editNote(o))}),t.j41(24,"mat-icon"),t.EFF(25,"edit"),t.k0s(),t.j41(26,"span"),t.EFF(27,"Edit note"),t.k0s()(),t.j41(28,"button",19),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.copyNote(o))}),t.j41(29,"mat-icon"),t.EFF(30,"file_copy"),t.k0s(),t.j41(31,"span"),t.EFF(32,"Make a copy"),t.k0s()(),t.nrm(33,"mat-divider"),t.j41(34,"button",19),t.bIt("click",function(){const o=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.deleteNote(o))}),t.j41(35,"mat-icon"),t.EFF(36,"delete"),t.k0s(),t.j41(37,"span"),t.EFF(38,"Delete note"),t.k0s()()()()()}if(2&l){const e=p.$implicit,n=t.sdS(14),o=t.sdS(22);t.Y8G("ngStyle",t.eq3(9,X,e.data.background)),t.R7$(),t.vxM(e.data.title?1:-1),t.R7$(2),t.JRh(e.data.body),t.R7$(2),t.Y8G("disabled",!0),t.R7$(12),t.Y8G("cdkConnectedOverlayHasBackdrop",!0)("cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop")("cdkConnectedOverlayOrigin",n)("cdkConnectedOverlayOpen",e.open),t.R7$(),t.Y8G("matMenuTriggerFor",o)}}let z=(()=>{class l{closeLabelsMenu(e){var n=this;return(0,d.A)(function*(){e.open=!1,console.log("Menu closed:",e),yield n.saveNote(e,e.data)})()}constructor(){var e=this;this.viewStyle=(0,t.geq)("card"),this.selectedTag="",this.bold=!1,this.bold2=!1,this.dialog=(0,t.WQX)(m.bZ),this.layout=(0,t.WQX)(O.Y),this.identity=(0,t.WQX)($.K),this.app=(0,t.WQX)(E.d),this.toppings=new r.MJ(""),this.labels=(0,t.vPA)(["Reminders","Inspiration","Personal","Work"]),this.labelMap={Reminders:"label1",Inspiration:"label2",Personal:"label3",Work:"label4"},this.records=(0,t.vPA)([]),this.checkedColumns=[],this.columnsCopy=[{key:1,title:"test"}],this.layout.disableNavigation(),this.layout.resetActions(),(0,t.QZP)((0,d.A)(function*(){e.app.initialized()&&(yield e.loadNotes())}))}deleteNote(e){var n=this;return(0,d.A)(function*(){const{status:o}=yield e.record.delete();o&&n.records.update(a=>a.filter(s=>s.record!=e.record))})()}newNote(){this.editNote({data:{title:"",body:"",background:"",collaborators:[],labels:[]}})}loadNotes(e){var n=this;return(0,d.A)(function*(){console.log("VALUE OF TAGS:",e);var{records:o}=yield n.identity.web5.dwn.records.query({message:{filter:{tags:e,protocol:g.Q.protocol,schema:g.Q.types.note.schema,dataFormat:g.Q.types.note.dataFormats[0]}}});if(n.records.set([]),o)for(const a of o){let s=yield a.data.json(),c={record:a,data:s};n.records.update(y=>[...y,c])}console.log("All requests:",n.records())})()}onSelectionChange(e){console.log("Selection changed:",e),console.log(this.selectedTag),this.selectedTag?this.loadNotes({labels:this.selectedTag}):this.loadNotes()}ngOnDestroy(){this.layout.enableScrolling()}copyNote(e){const n=JSON.parse(JSON.stringify(e.data));this.saveNote({data:n},n)}editNote(e){var n=this;let o={title:e.data.title,body:e.data.body,background:e.data.background,collaborators:[],labels:[""]};const a=JSON.parse(JSON.stringify(o)),s=this.dialog.open(V,{maxWidth:"80vw",maxHeight:"80vh",data:o});return s.afterClosed().subscribe(function(){var c=(0,d.A)(function*(y){y?(console.log("data result for saving:",o),e.data=o,yield n.saveNote(e,o)):o=a});return function(y){return c.apply(this,arguments)}}()),s.afterClosed()}ngOnInit(){}selectColor(){}onColorChange(e,n){return(0,d.A)(function*(){const o=e.target.value;console.log("Input value changed:",o),n.data.background=o;const{status:a,record:s}=yield n.record.update({data:n.data});console.log("Record updated:",s),console.log("Record status:",a)})()}saveNote(e,n){var o=this;return(0,d.A)(function*(){if(e.record){e.record.tags.labels=n.labels;const{status:a}=yield e.record.update({data:n});console.log("Record status:",a)}else{const{record:a,status:s}=yield o.identity.web5.dwn.records.create({data:n,message:{tags:{labels:n.labels},protocol:g.Q.protocol,protocolPath:"note",schema:g.Q.types.note.schema,dataFormat:g.Q.types.note.dataFormats[0]}});console.log("Record created:",a),console.log("Record status:",s),a&&(e.record=a,o.records.update(c=>[...c,e]))}})()}static#t=this.\u0275fac=function(n){return new(n||l)};static#e=this.\u0275cmp=t.VBU({type:l,selectors:[["app-notes"]],inputs:{viewStyle:[1,"viewStyle"]},outputs:{viewStyle:"viewStyleChange"},standalone:!0,features:[t.aNF],decls:14,vars:2,consts:[["fileColor",""],["trigger","cdkOverlayOrigin"],["menuActions","matMenu"],[1,"toolbar-actions","margin-bottom"],["type","button","mat-button","",3,"click"],[1,"notes"],[1,"notes-top"],[3,"ngModelChange","multiple","ngModel"],[3,"value"],[1,"notes-items"],[1,"marketplace-category",3,"ngStyle"],[3,"click","value"],[1,"note-body",3,"click"],["mat-icon-button","","matTooltip","Collaborator",3,"disabled"],["mat-icon-button","","matTooltip","Background",3,"click"],["type","color",1,"color-picker",3,"change"],["mat-icon-button","","matTooltip","Labels","type","button","cdkOverlayOrigin","",3,"click"],["cdkConnectedOverlay","",3,"backdropClick","cdkConnectedOverlayHasBackdrop","cdkConnectedOverlayBackdropClass","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen"],["mat-icon-button","","matTooltip","Options",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[3,"click"],["subscriptSizing","dynamic"],["multiple","",3,"ngModelChange","ngModel"],[1,"example-additional-selection"]],template:function(n,o){1&n&&(t.j41(0,"mat-card",3)(1,"mat-card-content")(2,"button",4),t.bIt("click",function(){return o.newNote()}),t.j41(3,"mat-icon"),t.EFF(4,"note_add"),t.k0s(),t.EFF(5," New note "),t.k0s()()(),t.j41(6,"div",5)(7,"div",6)(8,"mat-chip-listbox",7),t.mxI("ngModelChange",function(s){return t.DH7(o.selectedTag,s)||(o.selectedTag=s),s}),t.Z7z(9,x,2,2,"mat-chip-option",8,t.fX1),t.k0s()(),t.j41(11,"div",9),t.Z7z(12,Q,39,11,"mat-card",10,t.fX1),t.k0s()()),2&n&&(t.R7$(8),t.Y8G("multiple",!1),t.R50("ngModel",o.selectedTag),t.R7$(),t.Dyx(o.labels()),t.R7$(3),t.Dyx(o.records()))},dependencies:[C.MD,C.B3,v.Ve,h.rl,h.nJ,v.VO,v.$2,G.wT,m.hM,k.uc,k.oV,b.Hu,b.RN,b.m2,b.WQ,b.dh,N.YN,N.uI,N.gq,r.YN,r.BC,r.vS,u.Hl,u.$z,u.iY,_.m_,_.An,F.fS,S.Fg,I.q,f.Cn,f.kk,f.fb,f.Cp,T.Vg,h.RG,r.X1,j.z_,j.WB,j.$Q,B.iw],styles:[".notes[_ngcontent-%COMP%]{height:100%}.note-body[_ngcontent-%COMP%]{white-space:pre-wrap}.notes-top[_ngcontent-%COMP%]{margin-bottom:1em}.large-icon[_ngcontent-%COMP%]{transform:scale(2)}.marketplace-category[_ngcontent-%COMP%]{display:inline-block;padding:12px 16px;margin-right:1em;margin-bottom:1em;max-width:210px;font-size:.9em}.notes-items[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{cursor:pointer;padding:0!important;margin-bottom:.4em}.notes-items[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{cursor:pointer}.notes-items[_ngcontent-%COMP%]   mat-card-footer[_ngcontent-%COMP%]{font-size:1.2em;width:100%;text-align:center;display:block}"]})}return l})()}}]);