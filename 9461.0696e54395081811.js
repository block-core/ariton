"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9461],{39461:(K,c,a)=>{a.r(c),a.d(c,{IssuerComponent:()=>U});var m=a(10467),e=a(54438),g=a(88834),r=a(25596),h=a(99213),M=a(96084),I=a(34635),D=a(76336),p=a(22312),u=a(96850),F=a(36815),f=a(99631),C=a(53719),_=a(89417),y=a(60177);function T(o,l){1&o&&(e.j41(0,"mat-icon",12),e.EFF(1,"badge"),e.k0s(),e.EFF(2,"\xa0 Credentials "))}function R(o,l){1&o&&(e.j41(0,"mat-icon",12),e.EFF(1,"verified"),e.k0s(),e.EFF(2,"\xa0 Credential "))}function v(o,l){1&o&&e.EFF(0," You have signed the Voluntaryist Covenant ")}function O(o,l){1&o&&e.EFF(0," Sign the Voluntaryist Covenant ")}function k(o,l){1&o&&e.EFF(0," Signed Covenant ")}function P(o,l){1&o&&e.EFF(0," Sign Credential ")}function A(o,l){1&o&&(e.j41(0,"mat-icon",12),e.EFF(1,"person_search"),e.k0s(),e.EFF(2,"\xa0 Search "))}function j(o,l){1&o&&(e.j41(0,"mat-icon",13),e.EFF(1,"verified_user"),e.k0s())}function b(o,l){1&o&&(e.j41(0,"mat-icon",13),e.EFF(1,"gpp_bad"),e.k0s())}function S(o,l){1&o&&e.EFF(0," not ")}function B(o,l){if(1&o&&(e.j41(0,"p")(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e.EFF(4,"Signature Status"),e.k0s()(),e.j41(5,"mat-card-content")(6,"p"),e.DNE(7,j,2,0,"mat-icon",13)(8,b,2,0,"mat-icon",13),e.k0s(),e.j41(9,"p"),e.EFF(10,"The identity with the following DID has "),e.DNE(11,S,1,0),e.EFF(12," signed the convenant:"),e.k0s(),e.j41(13,"p",14),e.EFF(14),e.k0s()()()()),2&o){const n=e.XpG();e.R7$(7),e.vxM(n.lookupSigned?7:8),e.R7$(4),e.vxM(n.lookupSigned?-1:11),e.R7$(3),e.SpI(" ",n.did," ")}}let U=(()=>{class o{constructor(){this.vcType="IdentityCredential",this.app=(0,e.WQX)(M.d),this.identity=(0,e.WQX)(I.K),this.layout=(0,e.WQX)(F.Y),this.loading=!1,this.signed=!1,this.lookupSigned=void 0,this.did="",this.identifier="",this.name="",this.gender="",this.birthdate="",this.photograph="",this.credential="",this.layout.marginOff(),(0,e.QZP)(()=>{this.app.initialized()&&this.load()})}load(){var n=this;return(0,m.A)(function*(){var{records:d}=yield n.identity.web5.dwn.records.query({message:{filter:{schema:n.vcType,dataFormat:p.eE.format}}});d.length>0&&(n.signed=!0)})()}sign(){var n=this;return(0,m.A)(function*(){n.loading=!0;const d=new Date;d.setFullYear(d.getFullYear()+5);const t=yield D.l6.create({type:n.vcType,issuer:n.identity.did,subject:n.did,data:{identifier:n.identifier,name:n.name,dateOfBirth:n.birthdate,gender:n.gender,photo:n.photograph},expirationDate:d.toISOString()}),s=yield n.identity.activeAgent().did.get({didUri:n.identity.did});console.log("DID:",s);const i=yield n.identity.activeAgent().identity.list();console.log("Identitites:",i);const E=yield n.identity.activeAgent().identity.get({didUri:n.identity.did});console.log("this.identity.did:",n.identity.did),console.log("Bearer DID:",E),console.log("Active Agent:",n.identity.activeAgent());const W=yield t.sign({did:E.did});n.credential=W,n.signed=!0})()}lookup(){var n=this;return(0,m.A)(function*(){n.lookupSigned=void 0;const{records:d}=yield n.identity.web5.dwn.records.query({from:n.did,message:{filter:{schema:n.vcType,dataFormat:p.eE.format}}});console.log("VC RECORDS:",d),n.lookupSigned=d.length>0})()}withdraw(){var n=this;return(0,m.A)(function*(){var{records:d}=yield n.identity.web5.dwn.records.query({message:{filter:{schema:n.vcType,dataFormat:p.eE.format}}});for(const t of d)yield t.delete(),t.send(n.identity.did);n.loading=!1,n.signed=!1})()}static{this.\u0275fac=function(d){return new(d||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-issuer"]],standalone:!0,features:[e.aNF],decls:49,vars:12,consts:[["mat-tab-label",""],[1,"padding"],["subscriptSizing","dynamic",1,"did-input"],["matInput","","placeholder","DID",3,"ngModelChange","ngModel"],["matInput","","placeholder","Identifier",3,"ngModelChange","ngModel"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matInput","","placeholder","Birthdate",3,"ngModelChange","ngModel"],["matInput","","placeholder","Gender",3,"ngModelChange","ngModel"],["matInput","","placeholder","Photograph",3,"ngModelChange","ngModel"],["mat-flat-button","",3,"click","disabled"],["matInput","","placeholder","DID...",3,"ngModelChange","keydown.enter","ngModel"],["mat-icon-button","",1,"chat-action",3,"click"],[1,"example-tab-icon"],["inline","true",1,"signature-icon"],[1,"ellipsis"]],template:function(d,t){1&d&&(e.j41(0,"mat-tab-group")(1,"mat-tab"),e.DNE(2,T,3,0,"ng-template",0),e.j41(3,"div",1)(4,"mat-card")(5,"mat-card-content")(6,"h1"),e.EFF(7,"Choose Credential to issue"),e.k0s(),e.j41(8,"p"),e.EFF(9,"To be done: Add a list of available schemas to choose from."),e.k0s()()()()(),e.j41(10,"mat-tab"),e.DNE(11,R,3,0,"ng-template",0),e.j41(12,"div",1)(13,"mat-card")(14,"mat-card-header")(15,"mat-card-title"),e.DNE(16,v,1,0)(17,O,1,0),e.k0s()(),e.j41(18,"mat-card-content")(19,"mat-form-field",2)(20,"input",3),e.mxI("ngModelChange",function(i){return e.DH7(t.did,i)||(t.did=i),i}),e.k0s()(),e.j41(21,"mat-form-field",2)(22,"input",4),e.mxI("ngModelChange",function(i){return e.DH7(t.identifier,i)||(t.identifier=i),i}),e.k0s()(),e.j41(23,"mat-form-field",2)(24,"input",5),e.mxI("ngModelChange",function(i){return e.DH7(t.name,i)||(t.name=i),i}),e.k0s()(),e.j41(25,"mat-form-field",2)(26,"input",6),e.mxI("ngModelChange",function(i){return e.DH7(t.birthdate,i)||(t.birthdate=i),i}),e.k0s()(),e.j41(27,"mat-form-field",2)(28,"input",7),e.mxI("ngModelChange",function(i){return e.DH7(t.gender,i)||(t.gender=i),i}),e.k0s()(),e.j41(29,"mat-form-field",2)(30,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(t.photograph,i)||(t.photograph=i),i}),e.k0s()(),e.j41(31,"p"),e.EFF(32),e.k0s()(),e.j41(33,"mat-card-actions")(34,"button",9),e.bIt("click",function(){return t.sign()}),e.DNE(35,k,1,0)(36,P,1,0),e.k0s(),e.EFF(37,"\xa0 "),e.k0s()()()(),e.j41(38,"mat-tab"),e.DNE(39,A,3,0,"ng-template",0),e.j41(40,"div",1)(41,"h2"),e.EFF(42,"Check signing status"),e.k0s(),e.j41(43,"mat-form-field",2)(44,"input",10),e.mxI("ngModelChange",function(i){return e.DH7(t.did,i)||(t.did=i),i}),e.bIt("keydown.enter",function(){return t.lookup()}),e.k0s()(),e.j41(45,"button",11),e.bIt("click",function(){return t.lookup()}),e.j41(46,"mat-icon"),e.EFF(47,"search"),e.k0s()(),e.DNE(48,B,15,3,"p"),e.k0s()()()),2&d&&(e.R7$(16),e.vxM(t.signed?16:17),e.R7$(4),e.R50("ngModel",t.did),e.R7$(2),e.R50("ngModel",t.identifier),e.R7$(2),e.R50("ngModel",t.name),e.R7$(2),e.R50("ngModel",t.birthdate),e.R7$(2),e.R50("ngModel",t.gender),e.R7$(2),e.R50("ngModel",t.photograph),e.R7$(2),e.SpI(" ",t.credential," "),e.R7$(2),e.Y8G("disabled",t.loading||t.signed),e.R7$(),e.vxM(t.signed?35:36),e.R7$(9),e.R50("ngModel",t.did),e.R7$(4),e.vxM(void 0!==t.lookupSigned?48:-1))},dependencies:[y.MD,f.fS,f.fg,C.rl,C.RG,_.YN,_.me,_.BC,_.vS,_.X1,r.Hu,r.RN,r.YY,r.m2,r.MM,r.dh,h.m_,h.An,g.Hl,g.$z,g.iY,u.RI,u.ES,u.mq,u.T8],styles:[".did-input[_ngcontent-%COMP%]{width:calc(100% - 40px)}.signature-icon[_ngcontent-%COMP%]{font-size:4em}"]})}}return o})()}}]);