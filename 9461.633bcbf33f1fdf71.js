"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9461],{39461:(W,g,a)=>{a.r(g),a.d(g,{IssuerComponent:()=>B});var m=a(10467),e=a(54438),c=a(88834),s=a(25596),h=a(99213),M=a(96084),I=a(34635),D=a(76336),p=a(22312),u=a(96850),y=a(36815),f=a(99631),C=a(53719),_=a(89417),F=a(60177),T=a(26703);function R(o,r){1&o&&(e.j41(0,"mat-icon",13),e.EFF(1,"badge"),e.k0s(),e.EFF(2,"\xa0 Credentials "))}function v(o,r){1&o&&(e.j41(0,"mat-icon",13),e.EFF(1,"verified"),e.k0s(),e.EFF(2,"\xa0 Credential "))}function O(o,r){if(1&o){const t=e.RV6();e.j41(0,"p",9)(1,"strong"),e.EFF(2,"Credential:"),e.k0s(),e.nrm(3,"br"),e.EFF(4),e.j41(5,"button",14),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.copyValue())}),e.j41(6,"mat-icon"),e.EFF(7,"content_copy"),e.k0s()()()}if(2&o){const t=e.XpG();e.R7$(4),e.SpI(" ",t.credential," ")}}function k(o,r){1&o&&(e.j41(0,"mat-icon",13),e.EFF(1,"person_search"),e.k0s(),e.EFF(2,"\xa0 Search "))}function P(o,r){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"verified_user"),e.k0s())}function j(o,r){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"gpp_bad"),e.k0s())}function A(o,r){1&o&&e.EFF(0," not ")}function b(o,r){if(1&o&&(e.j41(0,"p")(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e.EFF(4,"Signature Status"),e.k0s()(),e.j41(5,"mat-card-content")(6,"p"),e.DNE(7,P,2,0,"mat-icon",15)(8,j,2,0,"mat-icon",15),e.k0s(),e.j41(9,"p"),e.EFF(10,"The identity with the following DID has "),e.DNE(11,A,1,0),e.EFF(12," signed the convenant:"),e.k0s(),e.j41(13,"p",16),e.EFF(14),e.k0s()()()()),2&o){const t=e.XpG();e.R7$(7),e.vxM(t.lookupSigned?7:8),e.R7$(4),e.vxM(t.lookupSigned?-1:11),e.R7$(3),e.SpI(" ",t.did," ")}}let B=(()=>{class o{constructor(){this.vcType="IdentityCredential",this.app=(0,e.WQX)(M.d),this.util=(0,e.WQX)(T.Q),this.identity=(0,e.WQX)(I.K),this.layout=(0,e.WQX)(y.Y),this.loading=!1,this.signed=!1,this.lookupSigned=void 0,this.did="",this.identifier="",this.name="",this.gender="",this.birthdate="",this.photograph="",this.credential="",this.layout.marginOff(),(0,e.QZP)(()=>{this.app.initialized()&&this.load()})}load(){var t=this;return(0,m.A)(function*(){var{records:d}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:p.eE.format}}});d.length>0&&(t.signed=!0)})()}copyValue(){this.util.copyToClipboard(this.credential)}sign(){var t=this;return(0,m.A)(function*(){t.loading=!0;const d=new Date;d.setFullYear(d.getFullYear()+5);const n=yield D.l6.create({type:t.vcType,issuer:t.identity.did,subject:t.did,data:{identifier:t.identifier,name:t.name,dateOfBirth:t.birthdate,gender:t.gender,photo:t.photograph},expirationDate:d.toISOString()}),l=yield t.identity.activeAgent().did.get({didUri:t.identity.did});console.log("DID:",l);const i=yield t.identity.activeAgent().identity.list();console.log("Identitites:",i);const E=yield t.identity.activeAgent().identity.get({didUri:t.identity.did});console.log("this.identity.did:",t.identity.did),console.log("Bearer DID:",E),console.log("Active Agent:",t.identity.activeAgent());const S=yield n.sign({did:E.did});t.credential=S,t.signed=!0})()}lookup(){var t=this;return(0,m.A)(function*(){t.lookupSigned=void 0;const{records:d}=yield t.identity.web5.dwn.records.query({from:t.did,message:{filter:{schema:t.vcType,dataFormat:p.eE.format}}});console.log("VC RECORDS:",d),t.lookupSigned=d.length>0})()}withdraw(){var t=this;return(0,m.A)(function*(){var{records:d}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:p.eE.format}}});for(const n of d)yield n.delete(),n.send(t.identity.did);t.loading=!1,t.signed=!1})()}static{this.\u0275fac=function(d){return new(d||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-issuer"]],standalone:!0,features:[e.aNF],decls:45,vars:10,consts:[["mat-tab-label",""],[1,"padding"],["subscriptSizing","dynamic",1,"did-input"],["matInput","","placeholder","DID",3,"ngModelChange","ngModel"],["matInput","","placeholder","Identifier",3,"ngModelChange","ngModel"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matInput","","placeholder","Birthdate",3,"ngModelChange","ngModel"],["matInput","","placeholder","Gender",3,"ngModelChange","ngModel"],["matInput","","placeholder","Photograph",3,"ngModelChange","ngModel"],[1,"wrap"],["mat-flat-button","",3,"click","disabled"],["matInput","","placeholder","DID...",3,"ngModelChange","keydown.enter","ngModel"],["mat-icon-button","",1,"chat-action",3,"click"],[1,"example-tab-icon"],["matTooltip","Copy the credential","mat-icon-button","",1,"copy-button",3,"click"],["inline","true",1,"signature-icon"],[1,"ellipsis"]],template:function(d,n){1&d&&(e.j41(0,"mat-tab-group")(1,"mat-tab"),e.DNE(2,R,3,0,"ng-template",0),e.j41(3,"div",1)(4,"mat-card")(5,"mat-card-content")(6,"h1"),e.EFF(7,"Choose Credential to issue"),e.k0s(),e.j41(8,"p"),e.EFF(9,"To be done: Add a list of available schemas to choose from."),e.k0s()()()()(),e.j41(10,"mat-tab"),e.DNE(11,v,3,0,"ng-template",0),e.j41(12,"div",1)(13,"mat-card")(14,"mat-card-header")(15,"mat-card-title"),e.EFF(16," Issue Credential "),e.k0s()(),e.j41(17,"mat-card-content")(18,"mat-form-field",2)(19,"input",3),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.k0s()(),e.j41(20,"mat-form-field",2)(21,"input",4),e.mxI("ngModelChange",function(i){return e.DH7(n.identifier,i)||(n.identifier=i),i}),e.k0s()(),e.j41(22,"mat-form-field",2)(23,"input",5),e.mxI("ngModelChange",function(i){return e.DH7(n.name,i)||(n.name=i),i}),e.k0s()(),e.j41(24,"mat-form-field",2)(25,"input",6),e.mxI("ngModelChange",function(i){return e.DH7(n.birthdate,i)||(n.birthdate=i),i}),e.k0s()(),e.j41(26,"mat-form-field",2)(27,"input",7),e.mxI("ngModelChange",function(i){return e.DH7(n.gender,i)||(n.gender=i),i}),e.k0s()(),e.j41(28,"mat-form-field",2)(29,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(n.photograph,i)||(n.photograph=i),i}),e.k0s()(),e.DNE(30,O,8,1,"p",9),e.k0s(),e.j41(31,"mat-card-actions")(32,"button",10),e.bIt("click",function(){return n.sign()}),e.EFF(33,"Sign Credential"),e.k0s()()()()(),e.j41(34,"mat-tab"),e.DNE(35,k,3,0,"ng-template",0),e.j41(36,"div",1)(37,"h2"),e.EFF(38,"Check signing status"),e.k0s(),e.j41(39,"mat-form-field",2)(40,"input",11),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.bIt("keydown.enter",function(){return n.lookup()}),e.k0s()(),e.j41(41,"button",12),e.bIt("click",function(){return n.lookup()}),e.j41(42,"mat-icon"),e.EFF(43,"search"),e.k0s()(),e.DNE(44,b,15,3,"p"),e.k0s()()()),2&d&&(e.R7$(19),e.R50("ngModel",n.did),e.R7$(2),e.R50("ngModel",n.identifier),e.R7$(2),e.R50("ngModel",n.name),e.R7$(2),e.R50("ngModel",n.birthdate),e.R7$(2),e.R50("ngModel",n.gender),e.R7$(2),e.R50("ngModel",n.photograph),e.R7$(),e.vxM(n.credential?30:-1),e.R7$(2),e.Y8G("disabled",n.loading),e.R7$(8),e.R50("ngModel",n.did),e.R7$(4),e.vxM(void 0!==n.lookupSigned?44:-1))},dependencies:[F.MD,f.fS,f.fg,C.rl,C.RG,_.YN,_.me,_.BC,_.vS,_.X1,s.Hu,s.RN,s.YY,s.m2,s.MM,s.dh,h.m_,h.An,c.Hl,c.$z,c.iY,u.RI,u.ES,u.mq,u.T8],styles:[".did-input[_ngcontent-%COMP%]{width:calc(100% - 40px)}.signature-icon[_ngcontent-%COMP%]{font-size:4em}"]})}}return o})()}}]);