"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4101],{64101:(N,h,r)=>{r.r(h),r.d(h,{KnownCustomerCredentialComponent:()=>B});var c=r(10467),e=r(54438),_=r(88834),l=r(25596),f=r(99213),M=r(96084),R=r(34635),E=r(76336),p=r(22312),m=r(96850),j=r(36815),v=r(99631),C=r(53719),u=r(89417),D=r(60177),k=r(26703),I=r(5951);function T(o,d){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"badge"),e.k0s(),e.EFF(2,"\xa0 About"))}function b(o,d){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"lock_reset"),e.k0s(),e.EFF(2,"\xa0 Permission "))}function w(o,d){1&o&&(e.j41(0,"p")(1,"mat-card",16)(2,"mat-card-content"),e.EFF(3," Successfully received permission to delivery credential."),e.k0s()()())}function O(o,d){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"verified"),e.k0s(),e.EFF(2,"\xa0 Credential "))}function K(o,d){if(1&o){const t=e.RV6();e.j41(0,"p")(1,"mat-card")(2,"mat-card-content")(3,"p",17)(4,"strong"),e.EFF(5,"Credential:"),e.k0s(),e.nrm(6,"br"),e.EFF(7),e.j41(8,"button",18),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.copyValue())}),e.j41(9,"mat-icon"),e.EFF(10,"content_copy"),e.k0s()()()()()()}if(2&o){const t=e.XpG();e.R7$(7),e.SpI(" ",t.credential," ")}}function P(o,d){1&o&&(e.j41(0,"mat-icon",15),e.EFF(1,"person_search"),e.k0s(),e.EFF(2,"\xa0 Validate"))}function S(o,d){1&o&&e.EFF(0," no ")}function A(o,d){if(1&o&&(e.j41(0,"h2"),e.EFF(1),e.k0s(),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.nI1(8,"json"),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI("Tier: ",t.vc.vcDataModel.credentialSubject.tier,""),e.R7$(2),e.SpI("Residence: ",t.vc.vcDataModel.credentialSubject.countryOfResidence,""),e.R7$(2),e.SpI("Jurisdiction: ",null==t.vc.vcDataModel.credentialSubject.jurisdiction?null:t.vc.vcDataModel.credentialSubject.jurisdiction.country,""),e.R7$(2),e.SpI("Evidence: ",e.bMT(8,4,null==t.vc.vcDataModel?null:t.vc.vcDataModel.evidence[0]),"")}}function U(o,d){if(1&o&&(e.j41(0,"p")(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e.EFF(4,"Known Customer Credential"),e.k0s()(),e.j41(5,"mat-card-content")(6,"p"),e.EFF(7,"The identity with the following DID has "),e.DNE(8,S,1,0),e.EFF(9," valid KCC issued by :"),e.k0s(),e.j41(10,"p",19),e.EFF(11),e.k0s(),e.DNE(12,A,9,6),e.k0s()()()),2&o){const t=d.$implicit,a=e.XpG(2);e.R7$(8),e.vxM(a.lookupSigned?-1:8),e.R7$(3),e.SpI(" ",t.vc.issuer," "),e.R7$(),e.vxM(t?12:-1)}}function W(o,d){if(1&o&&e.Z7z(0,U,13,3,"p",null,e.fX1),2&o){const t=e.XpG();e.Dyx(t.credentials)}}let B=(()=>{class o{constructor(){this.vcType="IdentityCredential",this.app=(0,e.WQX)(M.d),this.util=(0,e.WQX)(k.Q),this.identity=(0,e.WQX)(R.K),this.layout=(0,e.WQX)(j.Y),this.loading=!1,this.signed=!1,this.lookupSigned=void 0,this.did="did:dht:rr1w5z9hdjtt76e6zmqmyyxc5cfnwjype6prz45m6z1qsbm8yjao",this.identifier="",this.name="",this.gender="M",this.birthdate="",this.photograph="",this.credential="",this.issueDate="",this.expiryDate="",this.countryOfResidence="",this.tier="Silver",this.jurisdiction="",this.document_verification="passport utility_bill driver_license",this.permissionRequested=!1,this.permissionReceived=!1,this.credentials=[],this.vc=null,this.lookupCredential=null,this.layout.marginOff();const t=new Date;t.setHours(24,59,59,0);const a=new Date(t);a.setFullYear(a.getFullYear()+5),this.issueDate=t.toISOString(),this.expiryDate=a.toISOString(),(0,e.QZP)(()=>{this.app.initialized()&&this.load()})}requestPermission(){var t=this;return(0,c.A)(function*(){t.permissionRequested=!0;const a=t.identity.did;try{const n=yield fetch(`https://vc-to-dwn.tbddev.org/authorize?issuerDid=${a}`);console.log(n)}catch(n){console.log("Failed to request permission:",n)}t.permissionReceived=!0})()}load(){var t=this;return(0,c.A)(function*(){var{records:a}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:p.eE.format}}});a.length>0&&(t.signed=!0)})()}copyValue(){this.util.copyToClipboard(this.credential)}sign(){var t=this;return(0,c.A)(function*(){t.loading=!0;const a=new Date;a.setFullYear(a.getFullYear()+5),a.setHours(24,0,0,0);const n=yield E.l6.create({issuer:t.identity.did,subject:t.did,data:{countryOfResidence:t.countryOfResidence,tier:t.tier,jurisdiction:{country:t.jurisdiction}},expirationDate:a.toISOString(),evidence:[{kind:"document_verification",checks:t.document_verification.split(" ")}],credentialSchema:{id:"https://vc.schemas.host/kcc.schema.json",type:"JsonSchema"}}),s=yield t.identity.activeAgent().did.get({didUri:t.identity.did});console.log("DID:",s);const i=yield t.identity.activeAgent().identity.list();console.log("Identitites:",i);const y=yield t.identity.activeAgent().identity.get({didUri:t.identity.did});console.log("this.identity.did:",t.identity.did),console.log("Bearer DID:",y),console.log("Active Agent:",t.identity.activeAgent());const F=yield n.sign({did:y.did});t.credential=F;const{record:g,status:L}=yield t.identity.web5.dwn.records.create({data:F,message:{protocol:"https://vc-to-dwn.tbddev.org/vc-protocol",protocolPath:"credential",protocolRole:"issuer",schema:"https://vc-to-dwn.tbddev.org/vc-protocol/schema/credential",dataFormat:"application/vc+jwt"}});console.log("VC STATUS:",L),console.log("VC RECORD:",g);const{status:z}=yield g.send(t.did);console.log("Record sent:",z,g),t.signed=!0,t.loading=!1})()}lookup(){var t=this;return(0,c.A)(function*(){t.lookupSigned=void 0;const{records:a}=yield t.identity.web5.dwn.records.query({from:t.did,message:{filter:{schema:"https://vc-to-dwn.tbddev.org/vc-protocol/schema/credential",dataFormat:p.eE.format}}});if(console.log("VC RECORDS:",a),t.credentials=[],a.length>0)for(const n of a){t.lookupSigned=!0;const s=yield n.data.text();console.log(s);const i=E.l6.parseJwt({vcJwt:s});t.credentials.push({vc:i,jwt:s,record:n}),console.log(i.vcDataModel.credentialSubject)}else t.lookupSigned=!1})()}withdraw(){var t=this;return(0,c.A)(function*(){var{records:a}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:p.eE.format}}});for(const n of a)yield n.delete(),n.send(t.identity.did);t.loading=!1,t.signed=!1})()}static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-kcc"]],standalone:!0,features:[e.aNF],decls:73,vars:12,consts:[["mat-tab-label",""],[1,"padding"],["appearance","fill",1,"full-width"],["matInput","","placeholder","DID","readonly","true",3,"ngModelChange","ngModel"],["mat-button","",3,"click","disabled"],[1,"credential-form"],[1,"did-input"],["matInput","","placeholder","DID",3,"ngModelChange","ngModel"],["matInput","","placeholder","Eg. US",3,"ngModelChange","ngModel"],["matInput","",3,"ngModelChange","ngModel"],["matInput","","placeholder","Space separated list",3,"ngModelChange","ngModel"],["mat-flat-button","",3,"click","disabled"],["subscriptSizing","dynamic",1,"did-input"],["matInput","","placeholder","DID...",3,"ngModelChange","keydown.enter","ngModel"],["mat-icon-button","",1,"chat-action",3,"click"],[1,"example-tab-icon"],[1,"success"],[1,"wrap"],["matTooltip","Copy the credential","mat-icon-button","",1,"copy-button",3,"click"],[1,"ellipsis"]],template:function(a,n){1&a&&(e.j41(0,"mat-tab-group")(1,"mat-tab"),e.DNE(2,T,3,0,"ng-template",0),e.j41(3,"div",1)(4,"mat-card")(5,"mat-card-content")(6,"h1"),e.EFF(7,"Known Customer Credentials"),e.k0s(),e.j41(8,"p"),e.EFF(9," The Known Customer Credentials (KCC) is a decentralized identity system that allows individuals and companies to issue credentials to others about what evidence they have about specific identifiers (also known as customers). "),e.k0s(),e.j41(10,"p"),e.EFF(11," For example, a company may issue a credential to a customer that they have verified the customer's age and that it is above 18 years old. Third parties that trust You, or the company, can then verify the credential without getting any personal information about the customer themselves. "),e.k0s()()()()(),e.j41(12,"mat-tab"),e.DNE(13,b,3,0,"ng-template",0),e.j41(14,"div",1)(15,"mat-card")(16,"mat-card-content")(17,"h1"),e.EFF(18,"Ask for delivery permission"),e.k0s(),e.j41(19,"p"),e.EFF(20," You can ask for permission to deliver a credential to a specific DID. The DID is a decentralized identifier that is unique to the person or entity you want to deliver the credential to. "),e.k0s(),e.j41(21,"p")(22,"mat-form-field",2)(23,"mat-label"),e.EFF(24,"Enter DID"),e.k0s(),e.j41(25,"input",3),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.k0s()()(),e.j41(26,"p")(27,"button",4),e.bIt("click",function(){return n.requestPermission()}),e.EFF(28," Ask for permission "),e.k0s()()()(),e.DNE(29,w,4,0,"p"),e.k0s()(),e.j41(30,"mat-tab"),e.DNE(31,O,3,0,"ng-template",0),e.j41(32,"div",1)(33,"mat-card")(34,"mat-card-header")(35,"mat-card-title"),e.EFF(36," Issue Credential "),e.k0s()(),e.j41(37,"mat-card-content",5)(38,"mat-form-field",6)(39,"mat-label"),e.EFF(40,"Decentralized Identifier (DID)"),e.k0s(),e.j41(41,"input",7),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.k0s()(),e.j41(42,"mat-form-field",6)(43,"mat-label"),e.EFF(44,"Country of Residence"),e.k0s(),e.j41(45,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(n.countryOfResidence,i)||(n.countryOfResidence=i),i}),e.k0s()(),e.j41(46,"mat-form-field",6)(47,"mat-label"),e.EFF(48,"Customer Tier"),e.k0s(),e.j41(49,"input",9),e.mxI("ngModelChange",function(i){return e.DH7(n.tier,i)||(n.tier=i),i}),e.k0s()(),e.j41(50,"mat-form-field",6)(51,"mat-label"),e.EFF(52,"Jurisdiction"),e.k0s(),e.j41(53,"input",9),e.mxI("ngModelChange",function(i){return e.DH7(n.jurisdiction,i)||(n.jurisdiction=i),i}),e.k0s()(),e.j41(54,"mat-form-field",6)(55,"mat-label"),e.EFF(56,"Documents Verification"),e.k0s(),e.j41(57,"input",10),e.mxI("ngModelChange",function(i){return e.DH7(n.document_verification,i)||(n.document_verification=i),i}),e.k0s()()(),e.j41(58,"mat-card-actions")(59,"button",11),e.bIt("click",function(){return n.sign()}),e.EFF(60,"Sign and Save Credential"),e.k0s()()(),e.DNE(61,K,11,1,"p"),e.k0s()(),e.j41(62,"mat-tab"),e.DNE(63,P,3,0,"ng-template",0),e.j41(64,"div",1)(65,"h2"),e.EFF(66,"Check verification status"),e.k0s(),e.j41(67,"mat-form-field",12)(68,"input",13),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.bIt("keydown.enter",function(){return n.lookup()}),e.k0s()(),e.j41(69,"button",14),e.bIt("click",function(){return n.lookup()}),e.j41(70,"mat-icon"),e.EFF(71,"search"),e.k0s()(),e.DNE(72,W,2,0),e.k0s()()()),2&a&&(e.R7$(25),e.R50("ngModel",n.did),e.R7$(2),e.Y8G("disabled",n.permissionRequested),e.R7$(2),e.vxM(n.permissionReceived?29:-1),e.R7$(12),e.R50("ngModel",n.did),e.R7$(4),e.R50("ngModel",n.countryOfResidence),e.R7$(4),e.R50("ngModel",n.tier),e.R7$(4),e.R50("ngModel",n.jurisdiction),e.R7$(4),e.R50("ngModel",n.document_verification),e.R7$(2),e.Y8G("disabled",n.loading),e.R7$(2),e.vxM(n.credential?61:-1),e.R7$(7),e.R50("ngModel",n.did),e.R7$(4),e.vxM(void 0!==n.lookupSigned?72:-1))},dependencies:[D.MD,D.TG,v.fS,v.fg,C.rl,C.nJ,C.RG,u.YN,u.me,u.BC,u.vS,u.X1,l.Hu,l.RN,l.YY,l.m2,l.MM,l.dh,f.m_,f.An,_.Hl,_.$z,_.iY,m.RI,m.ES,m.mq,m.T8,I.Wk],styles:[".did-input[_ngcontent-%COMP%]{width:100%}.signature-icon[_ngcontent-%COMP%]{font-size:4em}.gender-input[_ngcontent-%COMP%]{margin-bottom:1em;display:inline-block}.credential-form[_ngcontent-%COMP%]{padding-top:1em}"]})}}return o})()}}]);