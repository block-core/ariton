"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9461],{39461:(b,c,a)=>{a.r(c),a.d(c,{IssuerComponent:()=>A});var _=a(10467),e=a(54438),m=a(88834),l=a(25596),p=a(99213),E=a(96084),I=a(34635),D=a(76336),u=a(22312),g=a(96850),y=a(36815),h=a(99631),f=a(53719),s=a(89417),R=a(60177),O=a(26703);function T(d,M){1&d&&(e.j41(0,"mat-icon",11),e.EFF(1,"badge"),e.k0s(),e.EFF(2,"\xa0 Credentials "))}function P(d,M){1&d&&(e.j41(0,"mat-icon",11),e.EFF(1,"verified"),e.k0s(),e.EFF(2,"\xa0 Credential "))}function v(d,M){if(1&d){const t=e.RV6();e.j41(0,"p",9)(1,"strong"),e.EFF(2,"Credential:"),e.k0s(),e.nrm(3,"br"),e.EFF(4),e.j41(5,"button",12),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.copyValue())}),e.j41(6,"mat-icon"),e.EFF(7,"content_copy"),e.k0s()()()}if(2&d){const t=e.XpG();e.R7$(4),e.SpI(" ",t.credential," ")}}let A=(()=>{class d{constructor(){this.vcType="IdentityCredential",this.app=(0,e.WQX)(E.d),this.util=(0,e.WQX)(O.Q),this.identity=(0,e.WQX)(I.K),this.layout=(0,e.WQX)(y.Y),this.loading=!1,this.signed=!1,this.lookupSigned=void 0,this.did="",this.identifier="",this.name="",this.gender="",this.birthdate="",this.photograph="",this.credential="",this.layout.marginOff(),(0,e.QZP)(()=>{this.app.initialized()&&this.load()})}load(){var t=this;return(0,_.A)(function*(){var{records:o}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:u.eE.format}}});o.length>0&&(t.signed=!0)})()}copyValue(){this.util.copyToClipboard(this.credential)}sign(){var t=this;return(0,_.A)(function*(){t.loading=!0;const o=new Date;o.setFullYear(o.getFullYear()+5);const n=yield D.l6.create({type:t.vcType,issuer:t.identity.did,subject:t.did,data:{identifier:t.identifier,name:t.name,dateOfBirth:t.birthdate,gender:t.gender,photo:t.photograph},expirationDate:o.toISOString()}),r=yield t.identity.activeAgent().did.get({didUri:t.identity.did});console.log("DID:",r);const i=yield t.identity.activeAgent().identity.list();console.log("Identitites:",i);const C=yield t.identity.activeAgent().identity.get({didUri:t.identity.did});console.log("this.identity.did:",t.identity.did),console.log("Bearer DID:",C),console.log("Active Agent:",t.identity.activeAgent());const F=yield n.sign({did:C.did});t.credential=F,t.signed=!0})()}lookup(){var t=this;return(0,_.A)(function*(){t.lookupSigned=void 0;const{records:o}=yield t.identity.web5.dwn.records.query({from:t.did,message:{filter:{schema:t.vcType,dataFormat:u.eE.format}}});console.log("VC RECORDS:",o),t.lookupSigned=o.length>0})()}withdraw(){var t=this;return(0,_.A)(function*(){var{records:o}=yield t.identity.web5.dwn.records.query({message:{filter:{schema:t.vcType,dataFormat:u.eE.format}}});for(const n of o)yield n.delete(),n.send(t.identity.did);t.loading=!1,t.signed=!1})()}static{this.\u0275fac=function(o){return new(o||d)}}static{this.\u0275cmp=e.VBU({type:d,selectors:[["app-issuer"]],standalone:!0,features:[e.aNF],decls:34,vars:8,consts:[["mat-tab-label",""],[1,"padding"],["subscriptSizing","dynamic",1,"did-input"],["matInput","","placeholder","DID",3,"ngModelChange","ngModel"],["matInput","","placeholder","Identifier",3,"ngModelChange","ngModel"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matInput","","placeholder","Birthdate",3,"ngModelChange","ngModel"],["matInput","","placeholder","Gender",3,"ngModelChange","ngModel"],["matInput","","placeholder","Photograph",3,"ngModelChange","ngModel"],[1,"wrap"],["mat-flat-button","",3,"click","disabled"],[1,"example-tab-icon"],["matTooltip","Copy the credential","mat-icon-button","",1,"copy-button",3,"click"]],template:function(o,n){1&o&&(e.j41(0,"mat-tab-group")(1,"mat-tab"),e.DNE(2,T,3,0,"ng-template",0),e.j41(3,"div",1)(4,"mat-card")(5,"mat-card-content")(6,"h1"),e.EFF(7,"Choose Credential to issue"),e.k0s(),e.j41(8,"p"),e.EFF(9,"To be done: Add a list of available schemas to choose from."),e.k0s()()()()(),e.j41(10,"mat-tab"),e.DNE(11,P,3,0,"ng-template",0),e.j41(12,"div",1)(13,"mat-card")(14,"mat-card-header")(15,"mat-card-title"),e.EFF(16," Issue Credential "),e.k0s()(),e.j41(17,"mat-card-content")(18,"mat-form-field",2)(19,"input",3),e.mxI("ngModelChange",function(i){return e.DH7(n.did,i)||(n.did=i),i}),e.k0s()(),e.j41(20,"mat-form-field",2)(21,"input",4),e.mxI("ngModelChange",function(i){return e.DH7(n.identifier,i)||(n.identifier=i),i}),e.k0s()(),e.j41(22,"mat-form-field",2)(23,"input",5),e.mxI("ngModelChange",function(i){return e.DH7(n.name,i)||(n.name=i),i}),e.k0s()(),e.j41(24,"mat-form-field",2)(25,"input",6),e.mxI("ngModelChange",function(i){return e.DH7(n.birthdate,i)||(n.birthdate=i),i}),e.k0s()(),e.j41(26,"mat-form-field",2)(27,"input",7),e.mxI("ngModelChange",function(i){return e.DH7(n.gender,i)||(n.gender=i),i}),e.k0s()(),e.j41(28,"mat-form-field",2)(29,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(n.photograph,i)||(n.photograph=i),i}),e.k0s()(),e.DNE(30,v,8,1,"p",9),e.k0s(),e.j41(31,"mat-card-actions")(32,"button",10),e.bIt("click",function(){return n.sign()}),e.EFF(33,"Sign Credential"),e.k0s()()()()()()),2&o&&(e.R7$(19),e.R50("ngModel",n.did),e.R7$(2),e.R50("ngModel",n.identifier),e.R7$(2),e.R50("ngModel",n.name),e.R7$(2),e.R50("ngModel",n.birthdate),e.R7$(2),e.R50("ngModel",n.gender),e.R7$(2),e.R50("ngModel",n.photograph),e.R7$(),e.vxM(n.credential?30:-1),e.R7$(2),e.Y8G("disabled",n.loading))},dependencies:[R.MD,h.fS,h.fg,f.rl,f.RG,s.YN,s.me,s.BC,s.vS,s.X1,l.Hu,l.RN,l.YY,l.m2,l.MM,l.dh,p.m_,p.An,m.Hl,m.$z,m.iY,g.RI,g.ES,g.mq,g.T8],styles:[".did-input[_ngcontent-%COMP%]{width:calc(100% - 40px)}.signature-icon[_ngcontent-%COMP%]{font-size:4em}"]})}}return d})()}}]);